<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Methods (BST 232) Notes - 13&nbsp; Week 12</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../week13/week13.html" rel="next">
<link href="../week11/week11.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-title">Week 12</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Methods (BST 232) Notes</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Methods (BST 232) Notes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week1/week1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 1</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week2/week2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 2</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week3/week3.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 3</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week4/week4.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 4</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week5/week5.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 5</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week6/week6.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 6</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week7/week7.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 7</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week8/week8.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 8</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week9/week9.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 9</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week10/week10.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 10</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week11/week11.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 11</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/week12.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Week 12</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week13/week13.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 13</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week14/week14.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 14</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#continuing-on-link-functions" id="toc-continuing-on-link-functions" class="nav-link active" data-scroll-target="#continuing-on-link-functions">Continuing on Link Functions</a>
  <ul class="collapse">
  <li><a href="#linear-identity-link-function" id="toc-linear-identity-link-function" class="nav-link" data-scroll-target="#linear-identity-link-function">Linear (identity) link function</a></li>
  <li><a href="#log-link-function" id="toc-log-link-function" class="nav-link" data-scroll-target="#log-link-function">Log link function</a></li>
  <li><a href="#logit-link-function" id="toc-logit-link-function" class="nav-link" data-scroll-target="#logit-link-function">Logit link function</a></li>
  <li><a href="#inverse-cdfs-as-link-functions-for-binary-outcomes" id="toc-inverse-cdfs-as-link-functions-for-binary-outcomes" class="nav-link" data-scroll-target="#inverse-cdfs-as-link-functions-for-binary-outcomes">Inverse CDFs as link functions for binary outcomes</a></li>
  <li><a href="#probit-link-function" id="toc-probit-link-function" class="nav-link" data-scroll-target="#probit-link-function">Probit Link Function</a></li>
  <li><a href="#complementary-log-log" id="toc-complementary-log-log" class="nav-link" data-scroll-target="#complementary-log-log">Complementary log-log</a></li>
  <li><a href="#comparing-links" id="toc-comparing-links" class="nav-link" data-scroll-target="#comparing-links">Comparing Links</a></li>
  </ul></li>
  <li><a href="#modeling-wester-collaborative-group-study-wcgs" id="toc-modeling-wester-collaborative-group-study-wcgs" class="nav-link" data-scroll-target="#modeling-wester-collaborative-group-study-wcgs">Modeling Wester Collaborative Group Study (WCGS)</a></li>
  <li><a href="#errors-with-alternative-links" id="toc-errors-with-alternative-links" class="nav-link" data-scroll-target="#errors-with-alternative-links">Errors with Alternative Links</a></li>
  <li><a href="#confounding-and-collapsibility" id="toc-confounding-and-collapsibility" class="nav-link" data-scroll-target="#confounding-and-collapsibility">Confounding and Collapsibility</a></li>
  <li><a href="#non-collapsibility-in-logistic-regression" id="toc-non-collapsibility-in-logistic-regression" class="nav-link" data-scroll-target="#non-collapsibility-in-logistic-regression">Non-Collapsibility in Logistic Regression</a></li>
  <li><a href="#lab" id="toc-lab" class="nav-link" data-scroll-target="#lab">Lab</a>
  <ul class="collapse">
  <li><a href="#comparison-of-approaches" id="toc-comparison-of-approaches" class="nav-link" data-scroll-target="#comparison-of-approaches">Comparison of Approaches</a>
  <ul class="collapse">
  <li><a href="#consider-a-binomial-problem" id="toc-consider-a-binomial-problem" class="nav-link" data-scroll-target="#consider-a-binomial-problem">Consider a Binomial Problem</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-title">Week 12</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="continuing-on-link-functions" class="level2">
<h2 class="anchored" data-anchor-id="continuing-on-link-functions">Continuing on Link Functions</h2>
<section id="linear-identity-link-function" class="level3">
<h3 class="anchored" data-anchor-id="linear-identity-link-function">Linear (identity) link function</h3>
<p>When we use the identity link function with binary outcomes, we call this a <span class="vocab">linear probability model</span>.</p>
<p><span class="math display">\[ \mu_i = \beta_0 + \beta_1 x_i \]</span></p>
<p>The contrast modeled is the <em>risk difference</em> (RD).</p>
<p><span class="math inline">\(\beta_0\)</span> is the probability of response when <span class="math inline">\(x = 0\)</span>; <span class="math inline">\(\beta_1\)</span> is the change in probability of response when <span class="math inline">\(x\)</span> differs by 1 unit.</p>
<p>We’ve noted before that this doesn’t respect the <span class="math inline">\([0,1]\)</span> bounds on the response probability.</p>
<p>We could also write <span class="math inline">\(\beta_1 = \mu[x^\star + 1] - \mu[x^\star]\)</span>.</p>
</section>
<section id="log-link-function" class="level3">
<h3 class="anchored" data-anchor-id="log-link-function">Log link function</h3>
<p>Suppose we choose the log link. The systematic component of the model is</p>
<p><span class="math display">\[\log(\mu_i) = \beta_0 + \beta_1 x_i\]</span></p>
<p>We interpret <span class="math inline">\(\beta_0\)</span> as the log of the probability of response when <span class="math inline">\(x = 0\)</span>. <span class="math inline">\(\exp(\beta_0)\)</span> is the probability of response when <span class="math inline">\(x=0\)</span>.</p>
<p>We interpret <span class="math inline">\(\beta_1\)</span> as the change in the log of the probability of response, comparing two populations whose values of <span class="math inline">\(x\)</span> differs by 1 unit.</p>
<p><span class="math inline">\(\exp(\beta_1)\)</span> is the ratio of the probability of response when comparing <span class="math inline">\(x^\star + 1\)</span> to <span class="math inline">\(x^\star\)</span>.</p>
<p><span class="math display">\[\beta_1 = \log(\mu[x^\star + 1]) - \log(\mu[x^\star]) = \log(\frac{\mu[x^\star + 1]}{\mu[x^\star]}),\]</span> <span class="math display">\[\exp(\beta_1) = \frac{\mu[x^\star + 1]}{\mu[x^\star]}.\]</span></p>
<p>The contrast we’re modeling here is the <em>risk ratio</em>.</p>
<p>The log link doesn’t necessarily respect the fact that the true response probability has an upper bound of 1. We can see this by considering the inverse of the link function: <span class="math display">\[\mu_i = \exp\{ \beta_0 + \beta_1 x_i \}\]</span> which takes values on <span class="math inline">\((0, \infty)\)</span>.</p>
</section>
<section id="logit-link-function" class="level3">
<h3 class="anchored" data-anchor-id="logit-link-function">Logit link function</h3>
<p>The logit link is the canonical link function for binary outcomes, and the GLM for Bernoulli outcomes using the logit link is known as logistic regression. The systematic component is:</p>
<p><span class="math display">\[\text{logit}(\mu_i) = \log \left( \frac{\mu_i}{1-\mu_i} \right) = \beta_0 + \beta_1 x_i. \]</span></p>
<p>The functional <span class="math display">\[\frac{\mu_i}{1-\mu_i} = \frac{P(Y_i = 1 \mid x_i)}{P(Y_i = 0 \mid x_i)}\]</span></p>
<p>is the odds of response.</p>
<p>We interpret <span class="math inline">\(\beta_0\)</span> as the log of the odds of response when <span class="math inline">\(x = 0\)</span>. <span class="math inline">\(\exp(\beta_0)\)</span> is the odds of response when <span class="math inline">\(x = 0\)</span>.</p>
<p><span class="math display">\[\beta_1 = \log\left( \frac{\mu[x^\star + 1]}{1-\mu[x^\star+1]}\right) - \log \left( \frac{\mu[x^\star]}{1 - \mu[x^\star]} \right).\]</span></p>
<p><span class="math display">\[\beta_1 = \log \left( \frac{\text{odds}(x^\star+1)}{\text{odds}(x^\star)} \right)\]</span></p>
<p>We typically report <span class="math inline">\(\exp(\beta_1)\)</span>, which is the ratio of the odds when <span class="math inline">\(x = x^\star + 1\)</span> to when <span class="math inline">\(x = x^\star\)</span>.</p>
<p>The inverse of the logit link function is called the expit function:</p>
<p><span class="math display">\[\mu_i = \frac{\exp \{ \beta_0 + \beta_1 x_i \} }{1 + \exp \{ \beta_0 + \beta_1 x_i \} }.\]</span></p>
</section>
<section id="inverse-cdfs-as-link-functions-for-binary-outcomes" class="level3">
<h3 class="anchored" data-anchor-id="inverse-cdfs-as-link-functions-for-binary-outcomes">Inverse CDFs as link functions for binary outcomes</h3>
<p>The logit function (the link for logistic regression) is the inverse CDF of the standard logistic distribution.</p>
<p>The CDF (of any distribution) provides a mapping from th support of the random variable to the <span class="math inline">\((0,1)\)</span> interval.</p>
<p><span class="math display">\[\mathbb{F}_X(\cdot) : (-\infty, \infty) \to (0,1)\]</span></p>
<p>It’s relatively common to use inverse CDFs as link functions.</p>
<p><span class="math display">\[\mathbb{F}^{-1}_X(\cdot) : (0,1) \to (-\infty, \infty)\]</span></p>
<p><span class="math inline">\(g(\cdot) \equiv \mathbb F^{-1}(\cdot)\)</span> maps <span class="math inline">\(\mu \in (0,1)\)</span> to <span class="math inline">\(\eta \in (-\infty, \infty)\)</span>.</p>
</section>
<section id="probit-link-function" class="level3">
<h3 class="anchored" data-anchor-id="probit-link-function">Probit Link Function</h3>
<p><span class="math display">\[\text{probit}(\mu_i) = \Phi^{-1}(\mu_i) = \beta_0 + \beta_1 x_i\]</span></p>
<p>where <span class="math inline">\(\Phi(\cdot)\)</span> is the CDF of the standard normal distribution.</p>
<p>Interpret <span class="math inline">\(\beta_0\)</span> as the probit of probability of response when <span class="math inline">\(x = 0\)</span>.</p>
<p>Interpret <span class="math inline">\(\beta_1\)</span> as the change in the probit of the probability of response, comparing two populations whose values of <span class="math inline">\(x\)</span> differs by 1 unit.</p>
<p>Interpretation is tricky:</p>
<ul>
<li>Contrast is in terms of the inverse CDF of a standard normal distribution.</li>
<li>There is no easy way of relating this contrast to more intuitive measures.</li>
</ul>
<p><span class="math inline">\(\beta_1\)</span> can be viewed as changes in <span class="math inline">\(z\)</span>-scores in the response probability.</p>
</section>
<section id="complementary-log-log" class="level3">
<h3 class="anchored" data-anchor-id="complementary-log-log">Complementary log-log</h3>
<p><span class="math display">\[\log(-\log(1-\mu_i)) = \beta_0 + \beta_1 x_i\]</span></p>
<p>Inverse CDF of the extreme value (or log-Weibull) distribution.</p>
<p>As with the probit function, there isn’t any intuitive way of interpreting regression parameters based on this link function.</p>
<p>Has the distinction that it is asymmetric.</p>
</section>
<section id="comparing-links" class="level3">
<h3 class="anchored" data-anchor-id="comparing-links">Comparing Links</h3>
<p><img src="images/comparing_links1.png" class="img-fluid"></p>
<p>Models using logit and probit links should give very similar predictions.</p>
<p>Shown by Amemiya (1981) there is an approximate relationship between the coefficients from models using the logit and probit links:</p>
<p><span class="math display">\[\beta_1^{\text{logit}} \approx 1.6 \beta_1^{\text{probit}}\]</span></p>
<p>Amemiya (1981) also shows that when <span class="math inline">\(\mu \in (0.3,0.7)\)</span>, there is an approximate relationship between the coefficients from models using the logit and linear links:</p>
<p><span class="math display">\[\beta_1^{\text{logit}} \approx \frac{\beta_1^{\text{\linear}}}{4}.\]</span></p>
<p>This might come from a relatively simple Taylor expansion of the expit function.</p>
<p><img src="images/comparing_links2.png" class="img-fluid"></p>
<p>When working with rare outcomes, the log, logit, and complementary log-log links give us pretty much the same things. When working with more common outcomes, the different links give us quite different outcomes.</p>
<p>From the figures, differences across these link functions manifest primarily in the tails when probability of response is small or large.</p>
<p>Also the logit and probit functions are almost linearly related.</p>
<p>For small values of <span class="math inline">\(\mu_i\)</span>, the complementary log-log, logit, and log functions are close to each other.</p>
<ul>
<li><p>Equally good for rare events</p></li>
<li><p>For <span class="math inline">\(\mu_i \leq 0.1\)</span> <span class="math display">\[\log \left( \frac{\mu_i}{1-\mu_i} \right) \approx \log(\mu_i) \]</span></p></li>
<li><p>log link has the best interpretation</p></li>
<li><p>OR and RR are close numerically</p></li>
</ul>
<p>What people often do is fit logistic regression, estimate an odds ratio, and then say because the OR is a rare outcome, it’s also approximately a rate ratio/relative risks. Why not just fit the log-link model? It may be computationally challenging/tricky.</p>
</section>
</section>
<section id="modeling-wester-collaborative-group-study-wcgs" class="level1">
<h1>Modeling Wester Collaborative Group Study (WCGS)</h1>
<p>Returning to the WCGS, the dataset has a number of covariates that we might consider including in a model for CHD risk:</p>
<ul>
<li>behavior pattern, age, height, weight, SBP, DBP, cholesterol, number of cigarettes smoked per day</li>
</ul>
<p>How do we approach making decisions about what to include in the model?</p>
<ul>
<li>Depends on the objective (association vs.&nbsp;prediction)</li>
<li>As usual, we’ll focus more on associational models here</li>
</ul>
<p>We discussed model selection based on <em>a priori</em> knowledge previously.</p>
<p>One strategy is to fit and report the following three models:</p>
<ol type="1">
<li><p>An unadjusted or minimally adjusted model (i.e., including only the variable of interest)</p></li>
<li><p>A model that includes ‘core’ confounders</p></li>
</ol>
<ul>
<li>Clear indication from scientific knowledge and/or the literature</li>
<li>Consensus among investigators</li>
</ul>
<ol start="3" type="1">
<li>A model that includes ‘core’ confounders plus any ‘potential’ confounders.</li>
</ol>
<ul>
<li>Indication is less certain.</li>
</ul>
<p>Then we would report analysis 2 as the main analysis, reporting analysis 1 and 3 as sensitivity analyses.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/WCGS_data.dat"</span>))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>wcgs<span class="sc">$</span>smoker <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(wcgs<span class="sc">$</span>ncigs <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>fit0 <span class="ot">&lt;-</span> <span class="fu">glm</span>(chd <span class="sc">~</span> behave, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> wcgs)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>jtools<span class="sc">::</span><span class="fu">summ</span>(fit0, <span class="at">confint =</span> T, <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">exp =</span> T, <span class="at">model.fit =</span> F, <span class="at">model.info =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
exp(Est.)
</th>
<th style="text-align:right;">
2.5%
</th>
<th style="text-align:right;">
97.5%
</th>
<th style="text-align:right;">
z val.
</th>
<th style="text-align:right;">
p
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
(Intercept)
</td>
<td style="text-align:right;">
0.053
</td>
<td style="text-align:right;">
0.042
</td>
<td style="text-align:right;">
0.067
</td>
<td style="text-align:right;">
-25.416
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
behave
</td>
<td style="text-align:right;">
2.373
</td>
<td style="text-align:right;">
1.803
</td>
<td style="text-align:right;">
3.123
</td>
<td style="text-align:right;">
6.163
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> Standard errors: MLE
</td>
</tr>
</tfoot>

</table>
</div>
</div>
<p>Add core adjustment variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(equatiomatic) <span class="co"># for extract_eq</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># see https://datalorax.github.io/equatiomatic/ </span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(chd <span class="sc">~</span> behave <span class="sc">+</span> age <span class="sc">+</span> wt <span class="sc">+</span> sbp <span class="sc">+</span> chol <span class="sc">+</span> smoker, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> wcgs)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">extract_eq</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 methods overwritten by 'broom':
  method            from  
  tidy.glht         jtools
  tidy.summary.glht jtools</code></pre>
</div>
<div class="cell-output-display">
<p><span class="math display">\[
\log\left[ \frac { P( \operatorname{chd} = \operatorname{1} ) }{ 1 - P( \operatorname{chd} = \operatorname{1} ) } \right] = \alpha + \beta_{1}(\operatorname{behave}) + \beta_{2}(\operatorname{age}) + \beta_{3}(\operatorname{wt}) + \beta_{4}(\operatorname{sbp}) + \beta_{5}(\operatorname{chol}) + \beta_{6}(\operatorname{smoker}_{\operatorname{TRUE}})
\]</span></p>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>jtools<span class="sc">::</span><span class="fu">summ</span>(fit1, <span class="at">confint =</span> T, <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">exp =</span> T, <span class="at">model.fit =</span> F, <span class="at">model.info =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
exp(Est.)
</th>
<th style="text-align:right;">
2.5%
</th>
<th style="text-align:right;">
97.5%
</th>
<th style="text-align:right;">
z val.
</th>
<th style="text-align:right;">
p
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
(Intercept)
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
-13.108
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
behave
</td>
<td style="text-align:right;">
1.988
</td>
<td style="text-align:right;">
1.498
</td>
<td style="text-align:right;">
2.639
</td>
<td style="text-align:right;">
4.755
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
age
</td>
<td style="text-align:right;">
1.065
</td>
<td style="text-align:right;">
1.040
</td>
<td style="text-align:right;">
1.090
</td>
<td style="text-align:right;">
5.228
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
wt
</td>
<td style="text-align:right;">
1.009
</td>
<td style="text-align:right;">
1.003
</td>
<td style="text-align:right;">
1.016
</td>
<td style="text-align:right;">
2.920
</td>
<td style="text-align:right;">
0.003
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
sbp
</td>
<td style="text-align:right;">
1.018
</td>
<td style="text-align:right;">
1.010
</td>
<td style="text-align:right;">
1.026
</td>
<td style="text-align:right;">
4.281
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
chol
</td>
<td style="text-align:right;">
1.011
</td>
<td style="text-align:right;">
1.008
</td>
<td style="text-align:right;">
1.014
</td>
<td style="text-align:right;">
7.253
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
smokerTRUE
</td>
<td style="text-align:right;">
1.834
</td>
<td style="text-align:right;">
1.393
</td>
<td style="text-align:right;">
2.416
</td>
<td style="text-align:right;">
4.319
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> Standard errors: MLE
</td>
</tr>
</tfoot>

</table>
</div>
</div>
<p>We think the <span class="math inline">\(\chi^2\)</span> reported in the model.fit statistics is the global <span class="math inline">\(\chi^2\)</span> statistic for a likelihood ratio test, but we should double-check.</p>
<p>The coefficients’ z-values and <span class="math inline">\(p\)</span>-values are related to univariate Wald tests.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># now including height and dystolic blood pressure</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(chd <span class="sc">~</span> behave <span class="sc">+</span> age <span class="sc">+</span> wt <span class="sc">+</span> sbp <span class="sc">+</span> chol <span class="sc">+</span> smoker <span class="sc">+</span> ht <span class="sc">+</span> dbp, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> wcgs)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>jtools<span class="sc">::</span><span class="fu">summ</span>(fit2, <span class="at">confint =</span> T, <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">exp =</span> T, <span class="at">model.fit =</span> F, <span class="at">model.info =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
exp(Est.)
</th>
<th style="text-align:right;">
2.5%
</th>
<th style="text-align:right;">
97.5%
</th>
<th style="text-align:right;">
z val.
</th>
<th style="text-align:right;">
p
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
(Intercept)
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
-5.926
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
behave
</td>
<td style="text-align:right;">
1.986
</td>
<td style="text-align:right;">
1.496
</td>
<td style="text-align:right;">
2.636
</td>
<td style="text-align:right;">
4.743
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
age
</td>
<td style="text-align:right;">
1.065
</td>
<td style="text-align:right;">
1.041
</td>
<td style="text-align:right;">
1.091
</td>
<td style="text-align:right;">
5.254
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
wt
</td>
<td style="text-align:right;">
1.008
</td>
<td style="text-align:right;">
1.001
</td>
<td style="text-align:right;">
1.016
</td>
<td style="text-align:right;">
2.110
</td>
<td style="text-align:right;">
0.035
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
sbp
</td>
<td style="text-align:right;">
1.019
</td>
<td style="text-align:right;">
1.006
</td>
<td style="text-align:right;">
1.031
</td>
<td style="text-align:right;">
2.876
</td>
<td style="text-align:right;">
0.004
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
chol
</td>
<td style="text-align:right;">
1.011
</td>
<td style="text-align:right;">
1.008
</td>
<td style="text-align:right;">
1.014
</td>
<td style="text-align:right;">
7.268
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
smokerTRUE
</td>
<td style="text-align:right;">
1.818
</td>
<td style="text-align:right;">
1.377
</td>
<td style="text-align:right;">
2.401
</td>
<td style="text-align:right;">
4.213
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
ht
</td>
<td style="text-align:right;">
1.018
</td>
<td style="text-align:right;">
0.954
</td>
<td style="text-align:right;">
1.087
</td>
<td style="text-align:right;">
0.550
</td>
<td style="text-align:right;">
0.582
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
dbp
</td>
<td style="text-align:right;">
0.999
</td>
<td style="text-align:right;">
0.978
</td>
<td style="text-align:right;">
1.020
</td>
<td style="text-align:right;">
-0.113
</td>
<td style="text-align:right;">
0.910
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> Standard errors: MLE
</td>
</tr>
</tfoot>

</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>jtools<span class="sc">::</span><span class="fu">export_summs</span>(fit0, fit1, fit2, <span class="at">exp =</span> T, <span class="at">error_format =</span> <span class="st">"[{conf.low}, {conf.high}]"</span>,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">error_pos =</span> <span class="st">'right'</span>, <span class="at">model.names =</span> <span class="fu">c</span>(<span class="st">'Unadjusted'</span>, <span class="st">'Core'</span>, <span class="st">'Full'</span>), <span class="at">statistics =</span> <span class="st">'AIC'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-4">
<colgroup><col><col><col><col><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Unadjusted</th><th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Core</th><th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Full</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(Intercept)</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.05 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">[0.04, 0.07]</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.00 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">[0.00, 0.00]</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.00 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">[0.00, 0.00]</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">behave</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2.37 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">[1.80, 3.12]</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.99 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">[1.50, 2.64]</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.99 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">[1.50, 2.64]</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">age</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.06 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">[1.04, 1.09]</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.07 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">[1.04, 1.09]</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">wt</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.01 **&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">[1.00, 1.02]</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.01 *&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">[1.00, 1.02]</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">sbp</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.02 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">[1.01, 1.03]</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.02 **&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">[1.01, 1.03]</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">chol</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.01 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">[1.01, 1.01]</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.01 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">[1.01, 1.01]</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">smokerTRUE</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.83 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">[1.39, 2.42]</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.82 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">[1.38, 2.40]</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">ht</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.02&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">[0.95, 1.09]</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">dbp</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.00&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">[0.98, 1.02]</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">AIC</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1744.34&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1599.92&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1603.59&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th colspan="7" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"> *** p &lt; 0.001;  ** p &lt; 0.01;  * p &lt; 0.05.</th></tr>
</tbody></table>

</div>
</div>
<p>Interpretation of <span class="math inline">\(\widehat{OR} = \exp(\beta_{\text{behave}}) = 1.99\)</span> from the core model:</p>
<ul>
<li>Odds of CHD in Type A men are 1.99 times those of Type B men</li>
<li>Odds of CHD are <span class="math inline">\((1.99 - 1) \times 100 = 99\%\)</span> greater for Type A vs.&nbsp;B.</li>
</ul>
<div class="hottip">
<p>Before we said that more than a ~10% change in a variable coefficient in going from an unadjusted to an adjusted model in a linear model setting is one heuristic for considering a variable as a potential confounder.</p>
<p>That heuristic no longer works in the GLM setting with non-identity links.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sometimes called a forest plot:</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>jtools<span class="sc">::</span><span class="fu">plot_summs</span>(fit0, fit1, fit2, <span class="at">exp =</span> T, </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">error_pos =</span> <span class="st">'right'</span>, <span class="at">model.names =</span> <span class="fu">c</span>(<span class="st">'Unadjusted'</span>, <span class="st">'Core'</span>, <span class="st">'Full'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week12_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">residuals</span>(fit2)), <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_histogram</span>() <span class="sc">+</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">xlab</span>(<span class="st">"Deviance residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">predict</span>(fit2), <span class="at">y =</span> <span class="fu">residuals</span>(fit2)), <span class="fu">aes</span>(x,y)) <span class="sc">+</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">xlab</span>(<span class="st">"Fitted values"</span>) <span class="sc">+</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ylab</span>(<span class="st">"Deviance residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="week12_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="week12_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<p>It’s hard to make much of the residuals… Recall that the deviance residuals are the preferred residuals in GLM settings.</p>
<p>So far, we’ve only considered the logit link function:</p>
<p><span class="math display">\[g(\mu_i) = \log \left( \frac{\mu_i}{1-\mu_i} \right) = x_i' \beta\]</span></p>
<p>By far this is the most common link function used for GLMs of binary data.</p>
<ul>
<li>It’s guaranteed that fitted values are in (0,1)</li>
<li>Reasonable interpretation of constrats in terms of odds ratios</li>
<li>When the event is rare, OR <span class="math inline">\(\approx\)</span> RR</li>
<li>We have the ability to synthesize case-control data as if it had been collected prospectively</li>
</ul>
<p>What about other link functions?</p>
<p>Potential choices include:</p>
<table class="table">
<thead>
<tr class="header">
<th>Link</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Linear</td>
<td><span class="math inline">\(g(\mu_i) = \mu_i\)</span></td>
</tr>
<tr class="even">
<td>Log</td>
<td><span class="math inline">\(g(\mu_i) = \log(\mu_i)\)</span></td>
</tr>
<tr class="odd">
<td>Probit</td>
<td><span class="math inline">\(g(\mu_i) = \text{probit}(\mu_i)\)</span></td>
</tr>
<tr class="even">
<td>Complementary Log-log</td>
<td><span class="math inline">\(g(\mu_i) = \log\{ - \log(1-\mu_i)\}\)</span></td>
</tr>
</tbody>
</table>
<p>For the goal of characterizing the association between behavior type and risk of CHD, interpretabililty is crucial.</p>
<ul>
<li>Thus we will examine the linear and log links, which give more interpretable coefficient estimates</li>
<li>If the goal were prediction, we’d be more likely to entertain the probit and complementary log-log links.</li>
</ul>
<p>In <code>R</code> we use the <code>family=</code> argument to change the link. Other components of the GLM that are functions of the link are appropriately adjusted.</p>
<p>First, consider changing the link in the unadjusted analysis:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>linearF0 <span class="ot">&lt;-</span> <span class="fu">glm</span>(chd <span class="sc">~</span> behave, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">'identity'</span>), <span class="at">data =</span> wcgs)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>jtools<span class="sc">::</span><span class="fu">export_summs</span>(linearF0,  <span class="at">error_format =</span> <span class="st">"[{conf.low}, {conf.high}]"</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">error_pos =</span> <span class="st">'right'</span>, <span class="at">model.names =</span> <span class="fu">c</span>(<span class="st">'Risk Differences'</span>), <span class="at">statistics =</span> <span class="st">'AIC'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-7">
<colgroup><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Risk Differences</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(Intercept)</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.05 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">[0.04, 0.06]</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">behave</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.06 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">[0.04, 0.08]</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">AIC</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1744.34&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th colspan="3" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"> *** p &lt; 0.001;  ** p &lt; 0.01;  * p &lt; 0.05.</th></tr>
</tbody></table>

</div>
</div>
<p>The main difference between using <code>link = 'identity'</code> vs.&nbsp;without inside the <code>binomial()</code> is that it’s changing the variance to use the binomial variance.</p>
<!-- It's also not `GLS`, because it's still performing Newton-Raphson. -->
<p>Note for thought: Think more about how this is not GLS: is it because it’s using Newton Raphson (?)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>logF0 <span class="ot">&lt;-</span> <span class="fu">glm</span>(chd <span class="sc">~</span> behave, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">'log'</span>), <span class="at">data =</span> wcgs)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>jtools<span class="sc">::</span><span class="fu">export_summs</span>(linearF0,  <span class="at">error_format =</span> <span class="st">"[{conf.low}, {conf.high}]"</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">error_pos =</span> <span class="st">'right'</span>, <span class="at">model.names =</span> <span class="fu">c</span>(<span class="st">'Relative Risks'</span>), <span class="at">statistics =</span> <span class="st">'AIC'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-8">
<colgroup><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Relative Risks</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(Intercept)</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.05 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">[0.04, 0.06]</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">behave</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.06 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">[0.04, 0.08]</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">AIC</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1744.34&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th colspan="3" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"> *** p &lt; 0.001;  ** p &lt; 0.01;  * p &lt; 0.05.</th></tr>
</tbody></table>

</div>
</div>
<p>Interpretation of <span class="math inline">\(\widehat{RR} = \exp(\hat \beta_{\text{behave}}) = 2.21\)</span>:</p>
<ul>
<li>The risk of CHD in Type A men is 2.21 times that of Type B men</li>
<li>The risk of CHD is <span class="math inline">\((2.21 - 1) \times 100 = 121\%\)</span> larger in Type A than Type B men</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>fv_tab <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">'model'</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'Logit'</span>, <span class="st">'Identity'</span>, <span class="st">'Log'</span>),</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(<span class="fu">summary</span>(fit0<span class="sc">$</span>fitted),</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(linearF0<span class="sc">$</span>fitted), <span class="fu">summary</span>(logF0<span class="sc">$</span>fitted)))</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">gt</span>(fv_tab) <span class="sc">|&gt;</span> </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="fu">md</span>(<span class="st">"**Comparison of Fitted Values**"</span>),</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="fu">md</span>(<span class="st">"Across logit, identity, and log link models"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(<span class="at">table.align=</span><span class="st">'left'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="zqmjjabjre" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#zqmjjabjre table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#zqmjjabjre thead, #zqmjjabjre tbody, #zqmjjabjre tfoot, #zqmjjabjre tr, #zqmjjabjre td, #zqmjjabjre th {
  border-style: none;
}

#zqmjjabjre p {
  margin: 0;
  padding: 0;
}

#zqmjjabjre .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: 0;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zqmjjabjre .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#zqmjjabjre .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zqmjjabjre .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zqmjjabjre .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zqmjjabjre .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zqmjjabjre .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zqmjjabjre .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zqmjjabjre .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zqmjjabjre .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zqmjjabjre .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zqmjjabjre .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zqmjjabjre .gt_spanner_row {
  border-bottom-style: hidden;
}

#zqmjjabjre .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#zqmjjabjre .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zqmjjabjre .gt_from_md > :first-child {
  margin-top: 0;
}

#zqmjjabjre .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zqmjjabjre .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zqmjjabjre .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#zqmjjabjre .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#zqmjjabjre .gt_row_group_first td {
  border-top-width: 2px;
}

#zqmjjabjre .gt_row_group_first th {
  border-top-width: 2px;
}

#zqmjjabjre .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zqmjjabjre .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#zqmjjabjre .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#zqmjjabjre .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zqmjjabjre .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zqmjjabjre .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zqmjjabjre .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#zqmjjabjre .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zqmjjabjre .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zqmjjabjre .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zqmjjabjre .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zqmjjabjre .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zqmjjabjre .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zqmjjabjre .gt_left {
  text-align: left;
}

#zqmjjabjre .gt_center {
  text-align: center;
}

#zqmjjabjre .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zqmjjabjre .gt_font_normal {
  font-weight: normal;
}

#zqmjjabjre .gt_font_bold {
  font-weight: bold;
}

#zqmjjabjre .gt_font_italic {
  font-style: italic;
}

#zqmjjabjre .gt_super {
  font-size: 65%;
}

#zqmjjabjre .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#zqmjjabjre .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#zqmjjabjre .gt_indent_1 {
  text-indent: 5px;
}

#zqmjjabjre .gt_indent_2 {
  text-indent: 10px;
}

#zqmjjabjre .gt_indent_3 {
  text-indent: 15px;
}

#zqmjjabjre .gt_indent_4 {
  text-indent: 20px;
}

#zqmjjabjre .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="7" class="gt_heading gt_title gt_font_normal" style=""><strong>Comparison of Fitted Values</strong></td>
    </tr>
    <tr class="gt_heading">
      <td colspan="7" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style="">Across logit, identity, and log link models</td>
    </tr>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="model">model</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Min.">Min.</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="X1st.Qu.">X1st.Qu.</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Median">Median</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Mean">Mean</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="X3rd.Qu.">X3rd.Qu.</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Max.">Max.</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="model" class="gt_row gt_left">Logit</td>
<td headers="Min." class="gt_row gt_right">0.05047923</td>
<td headers="X1st.Qu." class="gt_row gt_right">0.05047923</td>
<td headers="Median" class="gt_row gt_right">0.1120201</td>
<td headers="Mean" class="gt_row gt_right">0.08148383</td>
<td headers="X3rd.Qu." class="gt_row gt_right">0.1120201</td>
<td headers="Max." class="gt_row gt_right">0.1120201</td></tr>
    <tr><td headers="model" class="gt_row gt_left">Identity</td>
<td headers="Min." class="gt_row gt_right">0.05047923</td>
<td headers="X1st.Qu." class="gt_row gt_right">0.05047923</td>
<td headers="Median" class="gt_row gt_right">0.1120201</td>
<td headers="Mean" class="gt_row gt_right">0.08148383</td>
<td headers="X3rd.Qu." class="gt_row gt_right">0.1120201</td>
<td headers="Max." class="gt_row gt_right">0.1120201</td></tr>
    <tr><td headers="model" class="gt_row gt_left">Log</td>
<td headers="Min." class="gt_row gt_right">0.05047923</td>
<td headers="X1st.Qu." class="gt_row gt_right">0.05047923</td>
<td headers="Median" class="gt_row gt_right">0.1120201</td>
<td headers="Mean" class="gt_row gt_right">0.08148383</td>
<td headers="X3rd.Qu." class="gt_row gt_right">0.1120201</td>
<td headers="Max." class="gt_row gt_right">0.1120201</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>The fitted values are the same from the unadjusted logit, identity, and log link models because these are <em>saturated models</em>.</p>
<p>A <span style="vocab">saturated model</span> is a model that estimates a separate parameter for all unique values of <span class="math inline">\(x_i\)</span>.</p>
<p>There are numerous equivalent ways to define saturated models, so you may encounter other (equivalent) definitions elsewhere.</p>
<p>A model with a single binary predictor is saturated because there are two possible values of <span class="math inline">\(x_i\)</span> and two parameters <span class="math inline">\((\beta_0, \beta_1)\)</span>.</p>
<p>Because saturated models contain a separate parameter corresponding to each possible level of <span class="math inline">\(\mathbb E[Y_i \mid x_i] = \mu_i\)</span>, they can perfectly fit the expected value in each <span class="math inline">\(x\)</span> group.</p>
<p>I.e., <span class="math inline">\(\hat{\mathbb E}[Y_i \mid x_i = x^\star]\)</span> will be the sample mean of units with <span class="math inline">\(x = x^\star\)</span>.</p>
<p>Saturated models will thus give the same fitted values, <span class="math inline">\(\hat \mu_i\)</span>, regardless of the link function.</p>
</section>
<section id="errors-with-alternative-links" class="level1">
<h1>Errors with Alternative Links</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>linearF1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(chd <span class="sc">~</span> behave <span class="sc">+</span> age <span class="sc">+</span> wt <span class="sc">+</span> sbp <span class="sc">+</span> smoker, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">'identity'</span>),</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> wcgs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error: no valid set of coefficients has been found: please supply starting values</code></pre>
</div>
</div>
<p>Changing the link function from the default can cause IRLS to have trouble finding starting values.</p>
<p>For example, if we try to fit <code>glm(chd ~ behave + age + wt + sbp + chol + smoker, family = binomial(link='identity'), data = wcgs)</code>, we will get an error.</p>
<p>The problem is that it can’t find a set of starting coefficients where all of the predicted values are in the <span class="math inline">\((0,1)\)</span> range.</p>
<p>One option is to pass your own starting values in:</p>
<ul>
<li><code>start</code> for the regression coefficients <span class="math inline">\(\beta\)</span>,</li>
<li><code>etastart</code> for the linear predictors <span class="math inline">\(\{ \eta_1, ..., \eta_n \}\)</span></li>
<li><code>mustart</code> for the fitted values `<span class="math inline">\(\{ \mu_1, ..., \mu_n \}\)</span></li>
</ul>
<p>What people often do is to use the output from another model that didn’t fail. One option is to fit the logistic regression, get the fitted values from that model, and then specify those as the starting fitted values for any of these models using alternative link functions.</p>
<p>If at any point during the IRLS algorithm, one of the fitted values is outside <span class="math inline">\((0,1)\)</span>, then <span class="math inline">\(\text{Var}(Y_i) = \mu_i ( 1 - \mu_i)\)</span> will be negative. This makes it likely that the model will either error or be unlikely to converge.</p>
<p>An alternative computational option in the identity link setting is to use OLS with an appropriate variance estimator to account for the heteroscedasticity induced by the mean-variance relationship.</p>
<ul>
<li>Huber-White variance estimator</li>
<li>Bootstrap variance estimator</li>
</ul>
<p>In R:</p>
<ul>
<li>Use the <code>lm()</code> function</li>
<li>Use the <code>robustCI()</code> function</li>
</ul>
<p>We might also get similar errors about not finding valid starting values using a log link in a binomial outcome regression.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(chd <span class="sc">~</span> behave <span class="sc">+</span> age <span class="sc">+</span> wt <span class="sc">+</span> sbp <span class="sc">+</span> chol <span class="sc">+</span> smoker, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> wcgs)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>logF1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(chd <span class="sc">~</span> behave <span class="sc">+</span> age <span class="sc">+</span> wt <span class="sc">+</span> sbp <span class="sc">+</span> chol <span class="sc">+</span> smoker,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">'log'</span>), <span class="at">mustart =</span> <span class="fu">fitted</span>(fit1), <span class="at">data =</span> wcgs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in model.frame.default(formula = chd ~ behave + age + wt + sbp + : variable lengths differ (found for '(mustart)')</code></pre>
</div>
</div>
<p>If we use the log-link, we get a relative risk. The interpretation of <span class="math inline">\(\exp(\hat \beta_{\text{behave}}) = 1.78\)</span> is that it is the relative risk for Type A men is 78% higher than for Type B men, conditional on age, weight, SBP, cholesterol, and smoking.</p>
<div class="chilltip">
<p>When one has a rare outcome, it’s less likely one would have a fitted value greater than one. As a result, using a log link prevents the main concern, which is predicted probabilities below 0.</p>
</div>
</section>
<section id="confounding-and-collapsibility" class="level1">
<h1>Confounding and Collapsibility</h1>
<p>For a continuous response variable, consider two models that could be used to assess the <span class="math inline">\(Y - X\)</span> association:</p>
<p><span class="math display">\[\mathbb E[Y \mid X, Z] = \beta_0^c + \beta_X^c X + \beta_Z^c Z \label{eqn:1} \tag{1}\]</span> <span class="math display">\[\mathbb E[Y \mid X] = \beta_0^m + \beta_X^m X \label{eqn:2} \tag{2} \]</span></p>
<p>In model <span class="math inline">\(\ref{eqn:1}\)</span>, <span class="math inline">\(\beta_X^c\)</span> is a conditinoal parameter, where contrasts condition on the value of <span class="math inline">\(Z\)</span>.</p>
<p>In model <span class="math inline">\(\ref{eqn:2}\)</span>, <span class="math inline">\(\beta_X^m\)</span> is a marginal parameter, and contrasts using it do not condition on anything.</p>
<p>The relationship between the two parameters is clarified as follows:</p>
<p><span class="math display">\[\mathbb E[Y\mid X ] = \mathbb E_Z[\mathbb E_Y[Y \mid X,Z] \mid X ] \tiny{\tag{ Law of iterated expectations}}\]</span> <span class="math display">\[ = \mathbb E_Z[\beta_0^c + \beta_X^c X + \beta_Z^c Z ] \]</span> <span class="math display">\[ = \beta_0^c + \beta_X^c X + \beta_Z^c \mathbb E_Z[Z \mid X] \]</span></p>
<p>So the marginal contrast equals:</p>
<p><span class="math display">\[\beta_X^m = \mathbb E[Y \mid X = (x+1)] - \mathbb E[Y \mid X = x]\]</span> <span class="math display">\[ = \beta_X^c + \beta_Z^c \underbrace{\{ \mathbb E[Z \mid X = (x+1) - \mathbb E[Z \mid X = x]] \}}_{\text{slope from a linear regression of } Z \sim X } \]</span></p>
<p>Considering the model <span class="math inline">\(\mathbb E[Z \mid X] = \gamma_0 + \gamma_X X\)</span>,</p>
<p><span class="math display">\[\beta_X^m = \beta_X^c + \beta_Z^c \gamma_X.\]</span></p>
<p>The marginal contrast is the conditional plus a bias term.</p>
<p>The bias term (<span class="math inline">\(\beta_Z^c \gamma_X\)</span>) is non-zero if both</p>
<ul>
<li><span class="math inline">\(\beta_Z^c \neq 0\)</span>, i.e., <span class="math inline">\(Z\)</span> is related to <span class="math inline">\(Y\)</span> and</li>
<li><span class="math inline">\(\gamma_X \neq 0\)</span> i.e., <span class="math inline">\(Z\)</span> is related to <span class="math inline">\(X\)</span>,</li>
<li>i.e., <span class="math inline">\(Z\)</span> is a confounder.</li>
</ul>
<p>If <span class="math inline">\(Z\)</span> is a confounder and we don’t adjust for it, the marginal association we estimate will be biased.</p>
<!-- $$
\begin{aligned}
test & \\ 
test & \; \; blah & \quad \quad \quad \quad {\small\text{(Law of Iterated Expectations)}} \\ 
\end{aligned}
$$ -->
<p>The direction of the bias depends on the interplay between <span class="math inline">\(\beta_Z^c\)</span></p>
<p>If <span class="math inline">\(Z\)</span> isn’t a confounder, then one or both of <span class="math inline">\(\{ \beta_Z^c, \gamma_X \}\)</span> are zero, so the bias term is zero and <span class="math display">\[\beta_X^m = \beta_X^c.\]</span></p>
<p>So the marginal and conditional parameters are equivalent when the variables conditioned on are not confounders.</p>
<p>This is a result of the <span class="vocab">collapsibility</span> of parameters from a linear regression (or any GLM using the identity link).</p>
<div class="cooltip">
<p>Collapsibility is a broader concept that often deals with multi-way tables, but for our purposes, when we refer to collapsibility, we’ll be referring to this property: that if we condition on a variable that’s not a confounder, we don’t change the association parameter that we’re interested in.</p>
</div>
<p>If <span class="math inline">\(Z\)</span> is not a confounder, conditioning on it won’t do any harm since doing so does not change the quantity we’re estimating.</p>
<p>We call <span class="math inline">\(Z\)</span> a precision variable if it is associated with <span class="math inline">\(Y\)</span> but not <span class="math inline">\(X\)</span>.</p>
<p>If <span class="math inline">\(Z\)</span> is a precision variable, the standard error of <span class="math inline">\(\beta_X^c\)</span> will be smaller than the standard error of <span class="math inline">\(\beta_X^m\)</span>.</p>
<p>If <span class="math inline">\(Z\)</span> explains a substantial amount of variability in <span class="math inline">\(Y\)</span> then the conditional model SSE will be smaller, so <span class="math inline">\(\hat \sigma^2\)</span> will also generally be smaller for the conditional model.</p>
<p>Because linear regression parameters are collapsible and including precision variables in the model leads to smaller uncertainties, it’s generally good practice to condition on precision variables.</p>
<p>Is the same true for logistic regression?</p>
</section>
<section id="non-collapsibility-in-logistic-regression" class="level1">
<h1>Non-Collapsibility in Logistic Regression</h1>
<p>For a binary outcome, consider two models:</p>
<p><span class="math display">\[\text{logit} \mathbb E[Y \mid X, Z] = \beta_0^c + \beta_X^c X + \beta_Z^c Z \label{eqn:3} \tag{3}\]</span> <span class="math display">\[\text{logit} \mathbb E[Y \mid X] = \beta_0^m + \beta_X^m X \label{eqn:4} \tag{4}\]</span></p>
<p>The conditional odds ratio for a binary <span class="math inline">\(X\)</span> is</p>
<p><span class="math display">\[\theta_X^c = \exp (\beta_X^c) = \frac{\mathbb E[Y \mid X = 1, Z]}{1 - \mathbb E[Y \mid X = 1, Z]}
\bigg / \frac{\mathbb E[Y \mid X = 0, Z]}{1 - \mathbb E[Y \mid X = 0, Z]} \]</span></p>
<p>The marginal odds ratio for <span class="math inline">\(X\)</span> is</p>
<p><span class="math display">\[\theta_X^m = \exp (\beta_X^m) = \frac{\mathbb E[Y \mid X = 1]}{1 - \mathbb E[Y \mid X = 1]}
\bigg / \frac{\mathbb E[Y \mid X = 0]}{1 - \mathbb E[Y \mid X = 0]}.\]</span></p>
<p>Analagous to what we did for linear regression, we’d like to try to write the marginal OR as a function of the conditional.</p>
<p>Recall that to do this, we</p>
<ol type="1">
<li>Derived an expression for the marginal expectation <span class="math inline">\(\mathbb E[Y \mid X]\)</span> in terms of the conditional model parameters.</li>
<li>Plugged in for <span class="math inline">\(\mathbb E[Y \mid X]\)</span> in the marginal model contrast</li>
</ol>
<p><span class="math display">\[
\begin{aligned}
\mathbb E[Y \mid X] &amp; = \mathbb E_Z[\mathbb E_Y[Y \mid X, Z] \mid X] \\
&amp; = \mathbb E_Z\left[ \frac{\exp\{ \beta_0^c + \beta_X^c X + \beta_Z^c Z \} }{1 + \exp\{
  \beta_0^c + \beta_X^c X + \beta_Z^c Z
\}} \bigg\vert X \right] \\
&amp; = \int_Z \left( \frac{\exp\{ \beta_0^c + \beta_X^c X + \beta_Z^c Z \} }{1 + \exp\{
  \beta_0^c + \beta_X^c X + \beta_Z^c Z
\}} \right) f_{Z|X}(Z = z \mid X) \partial z \\
%  &amp; = \int_Z \left( \frac{\theta_X^c \exp\{ \beta_0^c+ \beta_Z^c Z \} }{1 + \theta_X^c \exp\{
%  \beta_0^c + \beta_Z^c Z
% \}} \right) f_{Z|X}(Z = z \mid X) \partial z.
\end{aligned}
\]</span></p>
<p>If we consider plugging this expression for <span class="math inline">\(\mathbb E[Y\mid X]\)</span> into</p>
<p><span class="math display">\[\theta_X^m = \exp (\beta_X^m) = \frac{\mathbb E[Y \mid X = 1]}{1 - \mathbb E[Y \mid X = 1]}
\bigg / \frac{\mathbb E[Y \mid X = 0]}{1 - \mathbb E[Y \mid X = 0]},\]</span></p>
<p>we can see that the relationship between the conditional OR <span class="math inline">\(\theta_X^m\)</span> and marginal OR <span class="math inline">\(\theta_X^m\)</span> is not straightforward.</p>
<p>There is no simple, closed-form expression for <span class="math inline">\(\theta_X^m\)</span> as a function of <span class="math inline">\(\theta_X^c\)</span>. Unlike in linear regression, they are not linearly related.</p>
<p>However, given <span class="math inline">\(\theta_X^c\)</span> we can calculate <span class="math inline">\(\theta_X^m\)</span> numerically.</p>
<p>To do so, from the expression for <span class="math inline">\(\mathbb E[Y \mid X]\)</span> we need to specify:</p>
<ul>
<li>values for all the parameters in the conditional model, <span class="math inline">\(f_{Z|X}(Z = z \mid X)\)</span>.</li>
</ul>
<p>For the purposes of this exercise, we’ll consider binary <span class="math inline">\(X\)</span> and <span class="math inline">\(Z\)</span> that are related via logistic regression</p>
<p><span class="math display">\[\text{logit} \mathbb E[Z \mid X] = \gamma_0 + \gamma_X X.\]</span></p>
<p>Notationally, let <span class="math inline">\(\phi_{XZ} = \exp(\gamma_X)\)</span> denote the <span class="math inline">\(Z \sim X\)</span> odds ratio.</p>
<p>We consider a range of values of</p>
<ul>
<li>The conditional odds ratio for <span class="math inline">\(X\)</span>, <span class="math inline">\(\theta_X^c\)</span>,</li>
<li>The conditional odds ratio for <span class="math inline">\(Z\)</span>, <span class="math inline">\(\theta_Z^c\)</span>,</li>
<li>The <span class="math inline">\(X/Z\)</span> odds ratio, <span class="math inline">\(\phi_{XZ}\)</span></li>
</ul>
<p>and for each scenario we compute <span class="math inline">\(\theta_X^m\)</span> and the percent difference:</p>
<p><span class="math display">\[\frac{\theta_X^m - \theta_X^c}{\theta_X^c} \times 100.\]</span></p>
</section>
<section id="lab" class="level1">
<h1>Lab</h1>
<p>Quick review of GLMs.</p>
<p>The exponential dispersion family can be written as</p>
<p><span class="math display">\[f(y \mid \theta, \phi) = \exp \left\{ \frac{y \theta - b(\theta)}{a(\phi)}  + c(y, \phi)\right\}\]</span></p>
<p>where <span class="math inline">\(\theta\)</span> is the canonical parameter and <span class="math inline">\(\phi\)</span> is the dispersion parameter. We also showed in class that</p>
<p><span class="math display">\[\mathbb E[Y_i] = \mu_i = b'(\theta_i)\]</span> <span class="math display">\[\text{Var}[Y_i] = b''(\theta_i) a_i(\phi)\]</span></p>
<p>We refer to <span class="math inline">\(b''(\theta_i)\)</span> as the variance function and sometimes we write it as <span class="math inline">\(V(\mu_i) = b''(\theta_i) = b''(b'^{-1}(\mu_i)),\)</span> i.e., <span class="math inline">\(V\)</span> can be some function of <span class="math inline">\(\mu\)</span>. Then we fit a GLM by assuming the model <span class="math inline">\(g(\mu_i) = \eta_i = X_i'\beta\)</span>.</p>
<section id="comparison-of-approaches" class="level2">
<h2 class="anchored" data-anchor-id="comparison-of-approaches">Comparison of Approaches</h2>
<p>Often linear models are motivated by the following minimization problem:</p>
<p><span class="math display">\[\min_{\beta} || \mathbf{y} - \mathbf{X} \beta ||_2^2\]</span></p>
<p>Assuming that <span class="math inline">\(\mathbb E[Y] = X \beta\)</span>.</p>
<p>A more statistically driven approach is to assume that</p>
<p><span class="math display">\[Y\mid X \sim \mathcal N(X \beta, \sigma^2),\]</span></p>
<p>and we want to <span class="math inline">\(\max_{\beta, \sigma^2} f_N(y, X, \beta) \approx e^{-\frac{(y-X\beta)^2}}.\)</span></p>
<p>It is a happy coincidence that in both the ML and statistically driven approach, we derive that <span class="math inline">\(\hat \beta = (X^T X)^{-1} X^T y\)</span>, “our favorite equation.”</p>
<section id="consider-a-binomial-problem" class="level3">
<h3 class="anchored" data-anchor-id="consider-a-binomial-problem">Consider a Binomial Problem</h3>
<p>Consider the problem where we have a binary random variable <span class="math inline">\(Y \sim \text{Bernoulli}(\mu)\)</span> with pdf</p>
<p><span class="math display">\[f_Y(y) = \mu^y(1-\mu)^{1-y}.\]</span></p>
<p>In this case, we assume that <span class="math display">\[Y \mid X \sim \text{Bernoulli}(\mathbb E(Y|X)),\]</span></p>
<p>and <span class="math inline">\(\mathbb E[Y|X] = \text{P}(Y = 1)\)</span>, therefore <span class="math inline">\(0 \leq \mathbb E[Y|X] \leq 1\)</span>.</p>
<p>There are several ways to enforce this bounding. Let <span class="math inline">\(\phi : \R \to [0,1]\)</span>.</p>
<ol type="1">
<li><p>One way could be to model <span class="math inline">\(\mathbb E(\phi(Y) | X)\)</span>, but this has two problems: interpretation, and more importantly, we’re not necessarily interested in the distribution of <span class="math inline">\(\phi(Y)\)</span>.</p></li>
<li><p>Another option is to transform the <span class="math inline">\(X\)</span> values so that <span class="math inline">\(\mathbb E(Y | X) = \phi(X) \beta\)</span>.</p></li>
<li><p>The last way is to write <span class="math inline">\(\mathbb E(Y) = \phi(X \hat \beta)\)</span>. Another way to write this is to let <span class="math inline">\(g = \phi^{-1}\)</span> and write <span class="math inline">\(g(\mathbb E(Y|X)) = X \hat \beta.\)</span></p></li>
</ol>
<p>We have two constraints on <span class="math inline">\(g\)</span>: it has to convert values from <span class="math inline">\(\R\)</span> to <span class="math inline">\([0,1]\)</span> as well as has nice interpretability.</p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th>Respects Constraints</th>
<th>Interpretable</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(g(y) = y\)</span></td>
<td>No</td>
<td>Very</td>
</tr>
<tr class="even">
<td>probit</td>
<td>Yes</td>
<td>Not very</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>(a). Show that this distribution belongs to the exponential dispersion family and find expressions for <span class="math inline">\(\theta\)</span>, <span class="math inline">\(b(\theta)\)</span>, <span class="math inline">\(a(\phi)\)</span>, and <span class="math inline">\(c(y, \phi)\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
f_Y(y) &amp; = \mu^y (1 - \mu)^{1-y} \\
&amp; = \exp \{ \log \{ \mu^y (1-\mu)^{1-y} \} \} \\
&amp; = \exp \{ y \log(\mu) + (1-\mu) \log(1-\mu) \} \\
&amp; = \exp \{ y \log \left( \frac{\mu}{1-\mu} + \log(1-\mu) \right) \} \\
&amp; = \exp \{ y \theta - \log(1 + \exp(\theta)) \},
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(\theta = \log \left( \frac{\mu}{1-\mu} \right)\)</span>, <span class="math inline">\(b(\theta) = \log(1 + \exp(\theta))\)</span>, <span class="math inline">\(a(\phi) = 1\)</span>, and <span class="math inline">\(c(y,\phi) = 0\)</span>.</p>
<p><span class="math inline">\(\theta\)</span> is often a nice candidate for the link function.</p>
<div class="cooltip">
<p>The exponential dispersion family is a generalization of what’s called the natural exponential family.</p>
</div>
<p>Recall that <span class="math inline">\(\text{expit}(X \hat \beta) = \frac{e^{X\beta}}{1-e^{X\hat\beta}}\)</span>.</p>
<p>Consider the simple logistic regression model for a binary outcome <span class="math inline">\(y_i\)</span> and a single covariate <span class="math inline">\(x_i\)</span></p>
<p><span class="math display">\[\text{\text{logit}}(\mu_i) = \beta_0 + \beta_1 x_i \tag{1} \]</span></p>
<p>where <span class="math inline">\(\mu_i = P(Y_i = 1 | X_i = x_i) = \mathbb E(Y_i | X_i = x_i)\)</span> and <span class="math inline">\(\text{logit}(\mu_i) = \log \left( \frac{\mu_i}{1-\mu_i} \right)\)</span>. Since we’ve already shown the Bernoulli distribution falls within the exponential dispersion family, it should be clear that model (1) is a GLM with the <span class="math inline">\(\text{logit}\)</span> link function.</p>
<p><span class="math inline">\(\beta_0\)</span> is the log odds of the outcome <span class="math inline">\(Y\)</span> for subjects with <span class="math inline">\(x_i = 0\)</span>.</p>
<p><span class="math display">\[\log \left( \frac{\mu_i}{1-\mu_i} \right) = \text{logit}(\mu_i) = \beta_0 + \beta_1(0) = \beta_0\]</span></p>
<p><span class="math inline">\(\beta_1\)</span></p>
<div class="chilltip">
<p>Advice for interpreting <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> for some random GLM on an exam:</p>
<p>Look at the difference between an observation with <span class="math inline">\(x^\star\)</span> and <span class="math inline">\(x^\star + 1\)</span>.</p>
<p><span class="math display">\[\log \left( \frac{\mu_i / (1-\mu_i)}{\mu_j/(1-\mu_j)} \right) =
\text{logit}(\mu_i) - \text{logit}(\mu_j) = \beta_0 + \beta_1(x + 1) - \beta_0 - \beta_1x = \beta_1\]</span></p>
</div>
<p>Now suppose we have collected <span class="math inline">\(n\)</span> independent observations. Show that the log-likelihood based on model (1) is</p>
<p><span class="math display">\[\ell(\beta_0, \beta_1 | y) = \sum_{i=1}^n \{ y_i (\beta_0 + \beta_1 x_i) - \log(1 + \exp(\beta_0 + \beta_1 x_i)) \}.\]</span></p>
<p>Answer:</p>
<p><span class="math display">\[L(\theta) = \prod \exp \{ y_i \theta_i - \log (1 + \exp \theta_i) \}\]</span></p>
<p>Therefore</p>
<p><span class="math display">\[\ell(\theta | y) = \sum y_i \theta_i - \log (1 + \exp \theta_i)\]</span> <span class="math display">\[\ell(\beta_0, \beta_1, y) = \sum y_i ( \beta_0 + \beta_1 x_i) - \log (1 + \exp(\beta_0 + \beta_1 x_i))\]</span></p>
<p>Obtain the score equations <span class="math inline">\(U(\beta_0)\)</span> and <span class="math inline">\(U(\beta_1)\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
U(\beta_0) = \frac{\partial \ell}{\partial \beta_0} &amp; = \sum_{i=1}^n \left\{
  y_i - \frac{\exp(\beta_0 + \beta_1 x_i)}{1 + \exp(\beta_0 + \beta_1 x_i)}
  \right\} \\
  &amp; = \sum (y_i - \mu_i) \stackrel{\text{set}}{=} 0
  \end{aligned}
  \]</span></p>
<p><span class="math display">\[
\begin{aligned}
U(\beta_1) = \frac{\partial \ell}{\partial \beta_1} &amp; = \sum_{i=1}^n \left\{
  y_i x_i - \frac{x_i \exp(\beta_0 + \beta_1 x_i)}{1 + \exp(\beta_0 + \beta_1 x_i)}
  \right\} \\
  &amp; = \sum x_i (y_i - \mu_i) \stackrel{\text{set}}{=} 0
  \end{aligned}
\]</span></p>
<p>Show that the Fisher Information Matrix <span class="math inline">\(\mathcal I(\beta)\)</span> takes the following form:</p>
<p><span class="math display">\[\mathcal I(\beta) = \pmatrix{
\sum \mu_i (1- \mu_i) &amp; \sum x_i \mu_i ( 1- \mu_i) \\
\sum x_i \mu_i (1-\mu_i) &amp; \sum x_i^2 \mu_i(1-\mu_i)
}.\]</span></p>
<p>Where <span class="math inline">\(\mu_i = \text{expit}(\beta_0 + \beta_1 x_i)\)</span> and <span class="math inline">\(\text{expit}(x) = \frac{\exp(x)}{1 + \exp(x)}\)</span></p>
<p>The Fisher Information Matrix is like the Hessian of the log-likelihood.</p>
<p>The higher the curvature, the lower the variance.</p>
<p>Appendix:</p>
<p>(Fill out soon…)</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../week11/week11.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Week 11</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../week13/week13.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-title">Week 13</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>