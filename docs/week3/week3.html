<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Methods (BST 232) Notes - 4&nbsp; Week 3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../week4/week4.html" rel="next">
<link href="../week2/week2.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-title">Week 3</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Methods (BST 232) Notes</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Methods (BST 232) Notes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week1/week1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 1</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week2/week2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 2</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week3/week3.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Week 3</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week4/week4.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 4</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week5/week5.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 5</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week6/week6.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 6</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week7/week7.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 7</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week8/week8.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 8</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week9/week9.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 9</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week10/week10.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 10</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week11/week11.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 11</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/week12.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 12</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week13/week13.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 13</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week14/week14.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 14</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#variance-of-hat-beta" id="toc-variance-of-hat-beta" class="nav-link active" data-scroll-target="#variance-of-hat-beta">Variance of <span class="math inline">\(\hat \beta\)</span></a>
  <ul class="collapse">
  <li><a href="#gauss-markov-theorem" id="toc-gauss-markov-theorem" class="nav-link" data-scroll-target="#gauss-markov-theorem">Gauss-Markov Theorem</a></li>
  <li><a href="#simple-linear-regression-as-a-special-case" id="toc-simple-linear-regression-as-a-special-case" class="nav-link" data-scroll-target="#simple-linear-regression-as-a-special-case">Simple Linear Regression as a Special Case</a></li>
  <li><a href="#normality-assumption" id="toc-normality-assumption" class="nav-link" data-scroll-target="#normality-assumption">Normality assumption</a></li>
  <li><a href="#joint-density" id="toc-joint-density" class="nav-link" data-scroll-target="#joint-density">Joint Density</a></li>
  </ul></li>
  <li><a href="#inference-in-linear-regression" id="toc-inference-in-linear-regression" class="nav-link" data-scroll-target="#inference-in-linear-regression">Inference in Linear Regression</a>
  <ul class="collapse">
  <li><a href="#sum-of-squares-decomposition" id="toc-sum-of-squares-decomposition" class="nav-link" data-scroll-target="#sum-of-squares-decomposition">Sum of squares decomposition</a></li>
  <li><a href="#overall-test" id="toc-overall-test" class="nav-link" data-scroll-target="#overall-test">Overall Test</a></li>
  </ul></li>
  <li><a href="#wald-tests" id="toc-wald-tests" class="nav-link" data-scroll-target="#wald-tests">Wald Tests</a></li>
  <li><a href="#testing-general-linear-hypotheses" id="toc-testing-general-linear-hypotheses" class="nav-link" data-scroll-target="#testing-general-linear-hypotheses">Testing general linear hypotheses</a></li>
  <li><a href="#confidence-intervals" id="toc-confidence-intervals" class="nav-link" data-scroll-target="#confidence-intervals">Confidence Intervals</a></li>
  <li><a href="#model-estimated-expected-value" id="toc-model-estimated-expected-value" class="nav-link" data-scroll-target="#model-estimated-expected-value">Model Estimated Expected Value</a>
  <ul class="collapse">
  <li><a href="#prediction-intervals" id="toc-prediction-intervals" class="nav-link" data-scroll-target="#prediction-intervals">Prediction Intervals</a></li>
  </ul></li>
  <li><a href="#r2-and-adjusted-r2" id="toc-r2-and-adjusted-r2" class="nav-link" data-scroll-target="#r2-and-adjusted-r2"><span class="math inline">\(R^2\)</span> and Adjusted <span class="math inline">\(R^2\)</span></a></li>
  <li><a href="#lab" id="toc-lab" class="nav-link" data-scroll-target="#lab">Lab</a>
  <ul class="collapse">
  <li><a href="#variance-estimates-to-confidence-intervals" id="toc-variance-estimates-to-confidence-intervals" class="nav-link" data-scroll-target="#variance-estimates-to-confidence-intervals">Variance estimates to confidence intervals</a></li>
  <li><a href="#hypothesis-testing" id="toc-hypothesis-testing" class="nav-link" data-scroll-target="#hypothesis-testing">Hypothesis Testing</a>
  <ul class="collapse">
  <li><a href="#f-tests-comparison-of-variances" id="toc-f-tests-comparison-of-variances" class="nav-link" data-scroll-target="#f-tests-comparison-of-variances">F-tests (comparison of variances)</a></li>
  </ul></li>
  <li><a href="#wald-test-comparison-of-means" id="toc-wald-test-comparison-of-means" class="nav-link" data-scroll-target="#wald-test-comparison-of-means">Wald test (comparison of means)</a></li>
  <li><a href="#additional-remarks" id="toc-additional-remarks" class="nav-link" data-scroll-target="#additional-remarks">Additional Remarks</a></li>
  <li><a href="#hypothesis-testing-for-nested-models-with-ordinalinteger-variables" id="toc-hypothesis-testing-for-nested-models-with-ordinalinteger-variables" class="nav-link" data-scroll-target="#hypothesis-testing-for-nested-models-with-ordinalinteger-variables">Hypothesis Testing for Nested Models with Ordinal/Integer Variables</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-title">Week 3</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Recap:</p>
<p>Recall that we can write in matrix notation:</p>
<p><span class="math display">\[Y = X\beta + \epsilon\]</span></p>
<p><span class="math display">\[\mathbb E(Y) = X\beta\]</span></p>
<p>Assuming that <span class="math inline">\(E(\epsilon) = 0\)</span> and <span class="math inline">\(\text{Var}(\epsilon) = \sigma^2I\)</span>.</p>
<p>Remember how we derived the formula for <span class="math inline">\(\hat \beta_{OLS}\)</span>? We set <span class="math inline">\(\frac{\partial}{\partial \beta} SSE(\beta) \stackrel{set}{=} 0\)</span>?</p>
<p>Calculating that out, we find that <span class="math display">\[ \frac{\partial}{\partial \beta} SSE(\beta) = -2X'y + 2X'X\beta, \]</span> <span class="math display">\[ \Longrightarrow X'X \hat \beta = X' y\]</span> <span class="math display">\[ \Longrightarrow \hat \beta_{OLS} = (X'X)^{-1}X'y\]</span></p>
<p>For standard linear regression (SLR), OLS slope estimates are a scaled correlation coefficient.</p>
<p>Recall that the vector of random values is a variance-covariance matrix.</p>
<p>Last time we showed that <span class="math inline">\(\hat \beta\)</span> is an unbiased estimator for <span class="math inline">\(\beta\)</span> when we saw that</p>
<p><span class="math display">\[\mathbb E(\hat \beta) = \mathbb E[\underbrace{(X'X)^{-1} X'}_{A} y] = (X'X)^{-1} X'X \beta = \beta\]</span></p>
<section id="variance-of-hat-beta" class="level2">
<h2 class="anchored" data-anchor-id="variance-of-hat-beta">Variance of <span class="math inline">\(\hat \beta\)</span></h2>
<p>The variance of <span class="math inline">\(\hat \beta\)</span> is expressed as the variance-covariance matrix</p>
<p><span class="math display">\[\text{Var}(\hat \beta) = (X'X)^{-1} X' \text{Var}(Y) X (X'X)^{-1}\]</span> <span class="math display">\[ = \sigma^2 (X'X)^{-1}\]</span></p>
<p>If we let <span class="math inline">\(D = (X'X)^{-1}\)</span>, the variance of <span class="math inline">\(\hat \beta_j = \sigma D_{jj}\)</span> and the covariance between <span class="math inline">\(\hat \beta_i\)</span> and <span class="math inline">\(\hat \beta_j\)</span> is <span class="math inline">\(\sigma^2 D_{ij}\)</span>.</p>
<p>How would we get to this result?</p>
<p>We are using a shorthand where we denote <span class="math inline">\((X'X)^TX' = A\)</span>, and now we’re just looking at the <span class="math inline">\(\text{Var}(AY)\)</span>. When we are working with the matrix-variance formula, we can rewrite <span class="math inline">\(\text{Var}(AY) = A\text{Var}(Y)A'\)</span>.</p>
<p>Plugging in the formula for <span class="math inline">\(A\)</span>, we get to the above.</p>
<p>Remember we said that <span class="math inline">\(\text{Var}(\epsilon) = \sigma^2\)</span> and <span class="math inline">\(Y = X\beta + \epsilon\)</span> where the only randomness comes from <span class="math inline">\(\epsilon\)</span>. In other words</p>
<p><span class="math display">\[\text{Var}(\hat \beta) = (X'X)^{-1} X' \text{Var}(Y) X (X'X)^{-1}\]</span> <span class="math display">\[ = (X'X)^{-1} X' \text{Var}(X\beta + \epsilon) X (X'X)^{-1}\]</span> <span class="math display">\[ = (X'X)^{-1} X' \text{Var}(\epsilon) X (X'X)^{-1}\]</span> <span class="math display">\[ = (X'X)^{-1} X' \sigma^2 I X (X'X)^{-1}\]</span> <span class="math display">\[ = \sigma^2 (X'X)^{-1} X' I X (X'X)^{-1}\]</span> <span class="math display">\[ = \sigma^2 \cancel{(X'X)^{-1} X' X }\underbrace{(X'X)^{-1}}_{\stackrel{set}{=}D}.\]</span></p>
<section id="gauss-markov-theorem" class="level3">
<h3 class="anchored" data-anchor-id="gauss-markov-theorem">Gauss-Markov Theorem</h3>
<div class="cooltip">
<p>Under the standard linear assumptions, <span class="math inline">\(\hat \beta_{OLS}\)</span> is the best linear unbiased estimator (BLUE) for <span class="math inline">\(\beta\)</span>.</p>
<p>Linear unbiased estimator: <span class="math inline">\(\hat \beta_{OLS}\)</span> is a linear combination of the observed <span class="math inline">\(y\)</span> values (given that <span class="math inline">\(\hat \beta = (X'X)^{-1}X'y\)</span> is a matrix of constants times a vector <span class="math inline">\(y\)</span>) and is an unbiased estimator.</p>
<p>It’s “best” in the sense that it is the lowest variance (most precise).</p>
</div>
<p>So the Gauss Markov Theorem tells us that among all linear, unbiased estimators of <span class="math inline">\(\beta\)</span>, <span class="math inline">\(\hat \beta_{OLS}\)</span> has the lowest variance.</p>
</section>
<section id="simple-linear-regression-as-a-special-case" class="level3">
<h3 class="anchored" data-anchor-id="simple-linear-regression-as-a-special-case">Simple Linear Regression as a Special Case</h3>
<p>The least squares estimators <span class="math inline">\(\hat \beta_0\)</span> and <span class="math inline">\(\hat \beta_1\)</span> can be expressed as</p>
<p><span class="math display">\[\hat \beta_0 = \sum_{i=1}^n l_i y_i, \quad \hat \beta_1 = \sum_{i=1}^n k_i y_i,\]</span></p>
<p>where <span class="math inline">\(l_i = \frac{1}{n} - \frac{\bar x(x_i - \bar x)}{\sum_{i=1}^n (x_i - \hat x)^2},\)</span> and <span class="math inline">\(k_i = \frac{(x_i - \bar x)}{\sum_{i=1}^n (x_i - \bar x)^2}\)</span>.</p>
<section id="variance-of-ls-estimators" class="level4">
<h4 class="anchored" data-anchor-id="variance-of-ls-estimators">Variance of LS Estimators</h4>
<p><span class="math display">\[\text{Var}(\hat \beta_0) = \sigma \left\{ \frac{1}{n} + \frac{\bar x^2}{\sum_{i=1}^n (x_i-\bar x)^2}\right\},\]</span> <span class="math display">\[\text{Var}(\hat \beta_1) = \sigma \left\{\frac{1}{\sum_{i=1}^n (x_i-\bar x)^2}\right\},\]</span> <span class="math display">\[\text{Cov}(\hat \beta_0, \hat \beta_1) = \sigma \left\{ - \frac{\bar x}{\sum_{i=1}^n (x_i-\bar x)^2}\right\}.\]</span></p>
<p>The variance-covariance matrix is</p>
<p><span class="math display">\[\text{Var}(\hat \beta) = \sigma(X'X)^{-1} = \left[ \begin{array}{cc} \text{Var}(\hat \beta_0) &amp; \text{Cov}(\hat \beta_0, \hat \beta_1) \\ \text{Cov}(\hat \beta_0, \hat \beta_1) &amp; \text{Var}(\hat \beta_1) \end{array} \right].\]</span></p>
</section>
<section id="estimation-of-sigma2" class="level4">
<h4 class="anchored" data-anchor-id="estimation-of-sigma2">Estimation of <span class="math inline">\(\sigma^2\)</span></h4>
<p>In order to estimate <span class="math inline">\(\text{Var}(\hat \beta)\)</span>, we need an estimator of <span class="math inline">\(\sigma^2\)</span>:</p>
<p>We base this on the sum of squared errors (SSE):</p>
<p><span class="math display">\[SSE = (y - X\hat\beta)'(y-X\hat \beta)\]</span> <span class="math display">\[ = \sum_{i=1}^n(y_i-x'_i\hat\beta)^2\]</span> <span class="math display">\[ = \sum_{i=1}^n (\hat \epsilon_i)^2\]</span></p>
<p><span class="math display">\[\hat \sigma^2 = MSE = \frac{SSE}{n - p - 1}.\]</span></p>
<p>This estimator <span class="math inline">\(\hat \sigma^2\)</span> is an unbiased estimator.</p>
<p>The <span class="math inline">\(n-p-1\)</span> in the denominator is because we estimate <span class="math inline">\(p+1\)</span> parameters and we divide by the degrees of freedom, which is <span class="math inline">\(n - \text{\# things we had to estimate}\)</span>. The Kutner book has a more rigorous presentation of why this is the right amount to divide by.</p>
</section>
</section>
<section id="normality-assumption" class="level3">
<h3 class="anchored" data-anchor-id="normality-assumption">Normality assumption</h3>
<p>If we are willing to make the stronger assumption that <span class="math inline">\(\epsilon_i \stackrel{iid}{\sim} \mathcal N(0, \sigma^2)\)</span>, then we can perform inference on <span class="math inline">\(\beta\)</span>.</p>
<p>First note that <span class="math inline">\(\epsilon_i \stackrel{iid}{\sim} \mathcal N(0, \sigma^2) \Longrightarrow Y_i \stackrel{ind}{\sim} \mathcal N(x_i'\beta, \sigma^2)\)</span>, such that</p>
<p><span class="math display">\[f_Y(y_i|\beta, \sigma^2) = \frac{1}{\sqrt{2\pi\sigma^2}} \exp\left[ -\frac{1}{2\sigma^2} (y_i - x_i'\beta)^2\right]\]</span></p>
<p>Notice that the <span class="math inline">\(Y_i\)</span> values are independent but not identically distributed.</p>
<p>Before we were just assuming that the <span class="math inline">\(\epsilon\)</span> values were uncorrelated, which in the special case of the normal distribution implies independence, but this isn’t necessarily so for other distributions.</p>
<p>We can then use maximum likelihood techniques to obtain <span class="math display">\[\hat \beta_{MLE} \sim MVN_{p+1} \left[ \beta, \sigma^2 (X'X)^{-1} \right].\]</span></p>
</section>
<section id="joint-density" class="level3">
<h3 class="anchored" data-anchor-id="joint-density">Joint Density</h3>
<p>Recap of maximum likelihood estimation.</p>
<p>In general, suppose we have data <span class="math inline">\(Y_1, ..., Y_n\)</span>, which are independent random variables with <span class="math inline">\(Y_i\)</span> having probability density function <span class="math display">\[f_Y(y_i|\theta)\]</span> where <span class="math inline">\(\theta\)</span> is a vector of unknown parameters.</p>
<p>Then the joint density function of all the <span class="math inline">\(y_i\)</span> given <span class="math inline">\(\theta\)</span> is the product of the individual densities</p>
<p><span class="math display">\[f(y_1, ..., y_n|\theta) = \prod_{i=1}^n f_Y(y_i|\theta).\]</span></p>
<section id="likelihood-functions" class="level4">
<h4 class="anchored" data-anchor-id="likelihood-functions">Likelihood Functions</h4>
<p>The <span class="vocab">likelihood function</span> of <span class="math inline">\(\theta\)</span> given the data has the same form as the joint pdf:</p>
<p><span class="math display">\[\mathcal L(\theta|y_1,...,y_n) = f(y_1, ..., y_n|\theta) = \prod_{i=1}^n f_Y(y_i|\theta).\]</span></p>
<p>Of course this looks exactly the same as the joint density of the <span class="math inline">\(Y_i\)</span> values, but instead this is a function of <span class="math inline">\(\theta\)</span> instead of a function of the <span class="math inline">\(y_i\)</span> values.</p>
<p>Once you take a random sample of size <span class="math inline">\(n\)</span>, the <span class="math inline">\(y_i\)</span> values are known, and the likelihood is considered as a function of unknown parameter <span class="math inline">\(\theta\)</span>.</p>
<p>The likelihood function should still integrate to 1.</p>
<p>The <span class="vocab">MLE</span> of <span class="math inline">\(\theta\)</span> is the value <span class="math inline">\(\hat \theta\)</span> that maximizes the likelihood</p>
<p><span class="math display">\[\mathcal L(\theta | y_1, ..., y_n)\]</span></p>
<p>as a function of <span class="math inline">\(\theta\)</span>.</p>
<p>The value <span class="math inline">\(\hat \theta\)</span> that maximizes <span class="math inline">\(\mathcal L(\theta)\)</span> also maximizes</p>
<p><span class="math display">\[\ell(\theta | y_1, ..., y_n) = \log \mathcal L(\theta | y_1, ..., y_n).\]</span></p>
</section>
<section id="solving-for-mle" class="level4">
<h4 class="anchored" data-anchor-id="solving-for-mle">Solving for MLE</h4>
<p><span class="math display">\[ \frac{\partial \ell}{\partial \theta} \stackrel{set}{=} 0,\]</span></p>
<p>and technically we’re going to need to check that this is a maximum as opposed to a minimum, and we’ll do so by checking that</p>
<p><span class="math display">\[\left[ \frac{\partial^2 \ell}{\partial \theta^2} \right]_{\theta = \hat \theta} &lt; 0.\]</span></p>
<p>If we were in a matrix setting instead of a vector setting, we’d need to check that the matrix is negative definite for a maximum, or positive definite for a minimum.</p>
<p>The negative of the second derivative,</p>
<p><span class="math display">\[\frac{-\partial^2 \ell(\theta | y_1, ..., y_n)}{\partial \theta^2},\]</span></p>
<p>is called the <span class="vocab">information</span>.</p>
</section>
<section id="returning-to-mle-for-regression" class="level4">
<h4 class="anchored" data-anchor-id="returning-to-mle-for-regression">Returning to MLE for Regression</h4>
<p>Thus in the linear regression setting if we assume <span class="math inline">\(\epsilon_i \stackrel{iid}{\sim} \mathcal N(0, \sigma^2),\)</span> then <span class="math inline">\(Y_i \stackrel{ind}{\sim} \mathcal N(x'_i\beta, \sigma^2)\)</span> and <span class="math display">\[f_Y(y_i|\beta, \sigma^2) = \frac{1}{\sqrt{2\pi\sigma^2}} \exp \left[ -\frac{1}{2\sigma^2} (y_i - x_i'\beta)^2\right]\]</span></p>
<p><span class="math display">\[\mathcal L(\beta, \sigma^2 | y_1, ..., y_n) = \prod_{i=1}^n f_Y(y_i|\beta, \sigma^2),\]</span></p>
<p>and</p>
<p><span class="math display">\[\mathcal L(\beta, \sigma^2|y_1, ..., y_n) = \left( \frac{1}{\sqrt{2\pi\sigma^2}}\right)^n
\exp \left[ - \frac{1}{2\sigma^2} \sum_{i=1}^n (y_i - x_i'\beta)^2 \right]\]</span> <span class="math display">\[= \left( \frac{1}{\sqrt{2\pi\sigma^2}}\right)^n
\exp \left[ - \frac{1}{2\sigma^2} (y - X\beta)'(y-X\beta) \right].\]</span></p>
<p>Turning to the log-likelihood function:</p>
<p><span class="math display">\[\ell(\beta, \sigma^2 | y_1, ..., y_n) \propto \cancel{-n/2\log(\sigma^2)} \underbrace{- \frac{1}{2\sigma^2} (y-X\beta)'(y-X\beta)}_{= \frac{-1}{2\sigma^2} S(\beta)}.\]</span></p>
<p>The values that maximize this log-likelihood with respect to <span class="math inline">\(\beta\)</span>, call them <span class="math inline">\(\hat \beta_{MLE}\)</span> are the same as those that minimize <span class="math inline">\(S(\hat \beta)\)</span>, i.e.,</p>
<p><span class="math display">\[\hat \beta_{MLE} = (X'X)^{-1}X'y\]</span></p>
<p>and it’s straightforward to show that</p>
<p><span class="math display">\[\hat \beta_{MLE} \sim MVN_{p+1}\left[ \beta, \sigma^2(X'X)^{-1} \right].\]</span></p>
</section>
<section id="sigma2_mle" class="level4">
<h4 class="anchored" data-anchor-id="sigma2_mle"><span class="math inline">\(\sigma^2_{MLE}\)</span></h4>
<p>While the estimates for <span class="math inline">\(\hat \beta\)</span> are the same for OLS vs.&nbsp;MLE, we have that <span class="math display">\[\hat \sigma^2_{MLE} = \frac{1}{n}(y-X\hat\beta)'(y-X\hat\beta) = \frac{(n-p-1)}{n}MSE\]</span></p>
<p>So of note, the MLE for <span class="math inline">\(\beta\)</span> are the same as the least squares estimator. However the MLE for <span class="math inline">\(\sigma^2\)</span> is not.</p>
<p>Recall that the least squares estimator of <span class="math inline">\(\sigma^2\)</span> is unbiased. The MLE of <span class="math inline">\(\sigma^2\)</span> is biased, although it is consistent: <span class="math display">\[\lim_{n\to\infty} P(|\hat\sigma^2 - \sigma^2| \leq \epsilon) \to 1, \, \forall \epsilon &gt; 0.\]</span></p>
</section>
</section>
</section>
<section id="inference-in-linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="inference-in-linear-regression">Inference in Linear Regression</h2>
<p>Often it’s of interest to determine if, collectively, a group of predictors significantly contribute to the variability in <span class="math inline">\(y\)</span> given another group of predictors are in the model.</p>
<p>Common examples are:</p>
<ul>
<li>Is a categorical variable, represented by dummy variables, significant (analagous to the overall ANOVA F-test)?</li>
<li>Can the effect of a predictor be represented as a linear effect or is a higher-level polynomial (i.e., using <span class="math inline">\(x^2\)</span>, <span class="math inline">\(x^3\)</span>, etc.) necessary?</li>
<li>Is a model that contains only main effects adequate or do we need to incorporate a set of interactions between variables in the models?</li>
</ul>
<section id="sum-of-squares-decomposition" class="level3">
<h3 class="anchored" data-anchor-id="sum-of-squares-decomposition">Sum of squares decomposition</h3>
<p><span class="math display">\[(y_i - \bar y)^2 = ((y_i - \hat y_i) + (\hat y_i - \bar y))^2\]</span></p>
<p>Then, when computing the sums of squares, we get</p>
<p><span class="math display">\[\sum(y_i - \bar y)^2 = \sum_{i=1}^n (\hat y_i - \bar y)^2 + \sum_{i=1}^n (y_i - \hat y_i)^2,\]</span></p>
<p>which happily features a “freshman’s dream”.</p>
<p>We thus have that <span class="math display">\[SST = \underbrace{SSR}_{\text{explained by regression}} + \underbrace{SSE}_{\text{left over}},\]</span></p>
<p>where <span class="math inline">\(SST = \text{Sums of Squares Total}\)</span>, <span class="math inline">\(SSR = \text{Sums of Squares Regression}\)</span>, and <span class="math inline">\(SSE = \text{Sums of Squares Error}\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="standalone_figures/residual_decompositions/residual_decomposition.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<section id="the-anova-like-table" class="level4">
<h4 class="anchored" data-anchor-id="the-anova-like-table">The ANOVA-like table</h4>
<p>We often will write something like this type of table:</p>
<table class="table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Source</th>
<th><span class="math inline">\(SS\)</span></th>
<th><span class="math inline">\(\text{df}\)</span></th>
<th><span class="math inline">\(\text{MS}\)</span></th>
<th><span class="math inline">\(\mathbb E[\text{MS}]\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Regression</td>
<td><span class="math inline">\(SSR = \hat \beta'X'y-n\bar y^2\)</span></td>
<td><span class="math inline">\(p\)</span></td>
<td><span class="math inline">\(\frac{SSR}{p}\)</span></td>
<td><span class="math inline">\(\sigma^2 + \frac{\beta'_Rx'_Cx_C\beta_R}{p}\)</span></td>
</tr>
<tr class="even">
<td>Error</td>
<td><span class="math inline">\(SSE = y'y - \hat \beta' X'y\)</span></td>
<td><span class="math inline">\(n-(p+1)\)</span></td>
<td><span class="math inline">\(\frac{SSE}{n-(p+1)}\)</span></td>
<td><span class="math inline">\(\sigma^2\)</span></td>
</tr>
<tr class="odd">
<td>Total</td>
<td><span class="math inline">\(SST=y'y - n \bar y^2\)</span></td>
<td><span class="math inline">\(n-1\)</span></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>where <span class="math inline">\(MS = \text{Mean Square Error}\)</span>, and <span class="math display">\[X_c = \left( \begin{array}{cccc}
x_{11}-\bar{x_1} &amp; x_{12}- \bar{x_2} &amp; \cdots &amp; x_{1p}-\bar{x_p} \\
x_{21}-\bar{x_1} &amp; x_{22}- \bar{x_2} &amp; \cdots &amp; x_{2p}-\bar{x_p} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
x_{n1}-\bar{x_1} &amp; x_{n2}- \bar{x_2} &amp; \cdots &amp; x_{np}-\bar{x_p}
\end{array}\right)\]</span></p>
</section>
<section id="testing-for-groups-of-predictors" class="level4">
<h4 class="anchored" data-anchor-id="testing-for-groups-of-predictors">Testing for Groups of Predictors</h4>
<p>How do we use this decomposition to test for a group of coefficients?</p>
<p>The hypothesis can be formulated as</p>
<p><span class="math display">\[H_0: \beta_1 = \beta_2 = ... = \beta_q = 0, q \leq p\]</span> <span class="math display">\[H_1: \text{ at least one of } \beta_1, ..., \beta_q \neq 0.\]</span></p>
<p>As an aside, tests of the overall regression and tests for a single variable fall within this framework as well:</p>
<p>The overall test:</p>
<p><span class="math display">\[H_0: \beta_1 = \beta_2 = ... = \beta_p = 0\]</span> <span class="math display">\[H_1: \beta_j \neq 0 \text{ for at least one } j, j = 1,...,p\]</span></p>
<p>For a single predictor:</p>
<p><span class="math display">\[H_0: \beta_j = 0\]</span> <span class="math display">\[H_1: \beta_j \neq 0\]</span></p>
<p>We like the property that testing for significance among a “group of coefficients” reduces in two special cases to either the overall test or a test for an individual coefficient.</p>
<p>If we consider the model in matrix form:</p>
<p><span class="math display">\[Y = X\beta + \epsilon,\]</span></p>
<p>to construct a test based on sums of squares, partition <span class="math inline">\(\beta\)</span> accordingly:</p>
<p><span class="math display">\[\beta = (\beta_1^, \beta_2')',\]</span></p>
<p>where <span class="math inline">\(\beta_1\)</span> is a <span class="math inline">\(q \times 1\)</span> and <span class="math inline">\(\beta_2\)</span> is <span class="math inline">\((p+1-q) \times 1\)</span>. We want to test the null hypothesis <span class="math display">\[H_0: \beta_1 = 0\]</span> <span class="math display">\[H_1: \beta_1 \neq 1\]</span> and <span class="math inline">\(\beta_2\)</span> is left unspecified.</p>
<p>Defining <span class="math inline">\(X = \left[ X_1, X_2 \right]\)</span>, rewrite the model as</p>
<p><span class="math display">\[Y = X_1 \beta_1 + X_2 + \beta_2 + \epsilon.\]</span></p>
<p>Now our model is partitioned so we’re ready to test for significance among the predictors and <span class="math inline">\(\beta\)</span> coefficients of interest.</p>
<p>The full model has SSR expressed as</p>
<p><span class="math display">\[SSR(X) = \hat \beta' X' y - n \bar y^2\]</span></p>
<p>and Mean Square Error</p>
<p><span class="math display">\[MSE(X) = \frac{y'y - \hat \beta' X' y}{n-p-1}.\]</span></p>
<p>To find the contribution of <span class="math inline">\(X_1\)</span>, fit the model assuming <span class="math inline">\(H_0\)</span> is true. The <span class="vocab">reduced model</span> is <span class="math display">\[Y = X_2 \beta_2 + \epsilon,\]</span> which yields <span class="math display">\[\hat \beta_2 = (X_2'X_2)^{-1}X_2'y \quad \text{ and } \quad SSR(X_2) = \hat \beta_2' X_2' y - n' \bar y^2.\]</span></p>
<p>The regression sums of squares due to <span class="math inline">\(X_1\)</span> given <span class="math inline">\(X_2\)</span> is in the model is</p>
<p><span class="math display">\[SSR(X_1|X_2) = SSR(X) - SSR(X_2)\]</span></p>
<p>with <span class="math inline">\(q\)</span> degrees of freedom. This is known as the <span class="vocab">extra sum of squares due to <span class="math inline">\(X_1\)</span> given <span class="math inline">\(X_2\)</span></span>.</p>
<p>Under the null hypothesis,</p>
<p><span class="math inline">\(SSR(X_1|X_2)/\sigma^2 \sim \chi_q^2\)</span> and <span class="math inline">\(SSE/\sigma^2 \sim \chi_{(n-p-1)}^2\)</span>, and these quantities are independent.</p>
<p>In general, if one <span class="math inline">\(\chi^2\)</span> distribution has degrees of freedom <span class="math inline">\(d_1\)</span> and another has <span class="math inline">\(d_2\)</span>, then <span class="math inline">\((\chi_{d_1}^2/d_2)/(\chi_{d_2}^2/d_2) \sim F_{d_1,d_2}\)</span> if the two are independent.</p>
<p>So we can test <span class="math inline">\(H_0: \beta_1 = 0\)</span> with the statistic <span class="math display">\[F = \frac{SSR(X_1|X_2)/q}{MSE(X)} \stackrel{H_0}{\sim} F_{q,n-p-1}\]</span></p>
<p>This <span class="math inline">\(F\)</span> distributional result requires either</p>
<ul>
<li>normality of errors <span class="math inline">\(\epsilon_i \sim \mathcal N(0,\sigma^2)\)</span></li>
<li>large sample theory</li>
</ul>
<p>There’s a handful of things above that we just have to take for granted assumed from a probability &amp; inference class and don’t have time to re-prove here.</p>
<p>The <span class="math inline">\(F\)</span> written above is an <span class="math inline">\(F\)</span>-statistic (or <span class="math inline">\(F\)</span>-distributed) because it is the quotient of two <span class="math inline">\(\chi^2\)</span>-distributed variables divided by their degrees of freedom.</p>
<p>With reasonably large sample size, <span class="math inline">\(\mathbb E[F_{q,n-p-1}] \approx 1\)</span>.</p>
<p>For example, one can see that if one runs the regressions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">data =</span> mtcars, hp <span class="sc">~</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fu">nrow</span>(mtcars)))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(.Last.value)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 0.06081 on 1 and 30 DF</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">data =</span> mtcars, hp <span class="sc">~</span> mpg)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... </span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 45.46 on 1 and 30 DF</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can think of this procedure as asking: Is the increase in the regression sums of squares associated with adding <span class="math inline">\(q\)</span> additional predictors, given the presence of the remaining variables in the model, sufficient to warrant removing <span class="math inline">\(q\)</span> additional degrees of freedom from the denominator of MSE?</p>
<p>Adding an unimportant predictor may increase the MSE, which will increase the uncertainty in the regression coefficient estimates and the variance of <span class="math inline">\(\hat y\)</span> - so we should include only predictors that explain the response.</p>
<p>Note however that for the purpose of explanation confounders may not reach significance at given level (e.g.&nbsp;<span class="math inline">\(\alpha = 0.05\)</span>) but still have a clinically relevant effect on both outcome and exposure and therefore affect the regression coefficients of interest.</p>
</section>
<section id="example-test-for-2-bmi-terms-hers-data" class="level4">
<h4 class="anchored" data-anchor-id="example-test-for-2-bmi-terms-hers-data">Example: Test for 2 BMI Terms, HERS Data</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.2     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>hers <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/hers.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 2763 Columns: 40
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (16): HT, raceth, nonwhite, smoking, drinkany, exercise, physact, globra...
dbl (24): age, medcond, weight, BMI, waist, WHR, glucose, weight1, BMI1, wai...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>hers<span class="sc">$</span>BMIc <span class="ot">&lt;-</span> hers<span class="sc">$</span>BMI <span class="sc">-</span> <span class="fu">mean</span>(hers<span class="sc">$</span>BMI, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>lm.ldl.interact <span class="ot">&lt;-</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(<span class="at">data =</span> hers <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span> <span class="fu">is.na</span>(BMIc)), LDL <span class="sc">~</span> BMIc<span class="sc">*</span>statins <span class="sc">+</span> age <span class="sc">+</span> nonwhite <span class="sc">+</span> drinkany <span class="sc">+</span> smoking)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>lm.ldl.noBMI <span class="ot">&lt;-</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(<span class="at">data =</span> hers <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span> <span class="fu">is.na</span>(BMIc)), LDL <span class="sc">~</span> statins <span class="sc">+</span> age <span class="sc">+</span> nonwhite <span class="sc">+</span> drinkany <span class="sc">+</span> smoking)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co"># perform f-test using anova(reducedModel, fullModel)</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>bmi.test <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(<span class="fu">anova</span>(lm.ldl.noBMI, lm.ldl.interact))</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="do">## format and print results table </span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="fu">gt</span>(bmi.test) <span class="sc">%&gt;%</span> </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="fu">md</span>(<span class="st">"**Test of significance of BMI**"</span>),</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">subtitle =</span> <span class="fu">md</span>(<span class="st">"From LDL model with BMI * statin interaction"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_width</span>(term <span class="sc">~</span> <span class="fu">px</span>(<span class="dv">375</span>)) <span class="sc">%&gt;%</span> <span class="fu">sub_missing</span>(<span class="at">missing_text =</span> <span class="st">''</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns=</span><span class="fu">c</span>(<span class="st">'statistic'</span>,<span class="st">'p.value'</span>),<span class="at">decimals=</span><span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(<span class="at">table.align=</span><span class="st">'left'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="tsrmcdtdxr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#tsrmcdtdxr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#tsrmcdtdxr thead, #tsrmcdtdxr tbody, #tsrmcdtdxr tfoot, #tsrmcdtdxr tr, #tsrmcdtdxr td, #tsrmcdtdxr th {
  border-style: none;
}

#tsrmcdtdxr p {
  margin: 0;
  padding: 0;
}

#tsrmcdtdxr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: 0;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#tsrmcdtdxr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#tsrmcdtdxr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#tsrmcdtdxr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#tsrmcdtdxr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tsrmcdtdxr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tsrmcdtdxr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tsrmcdtdxr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#tsrmcdtdxr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#tsrmcdtdxr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#tsrmcdtdxr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#tsrmcdtdxr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#tsrmcdtdxr .gt_spanner_row {
  border-bottom-style: hidden;
}

#tsrmcdtdxr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#tsrmcdtdxr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#tsrmcdtdxr .gt_from_md > :first-child {
  margin-top: 0;
}

#tsrmcdtdxr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#tsrmcdtdxr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#tsrmcdtdxr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#tsrmcdtdxr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#tsrmcdtdxr .gt_row_group_first td {
  border-top-width: 2px;
}

#tsrmcdtdxr .gt_row_group_first th {
  border-top-width: 2px;
}

#tsrmcdtdxr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tsrmcdtdxr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#tsrmcdtdxr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#tsrmcdtdxr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tsrmcdtdxr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tsrmcdtdxr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#tsrmcdtdxr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#tsrmcdtdxr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#tsrmcdtdxr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tsrmcdtdxr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tsrmcdtdxr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tsrmcdtdxr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tsrmcdtdxr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tsrmcdtdxr .gt_left {
  text-align: left;
}

#tsrmcdtdxr .gt_center {
  text-align: center;
}

#tsrmcdtdxr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#tsrmcdtdxr .gt_font_normal {
  font-weight: normal;
}

#tsrmcdtdxr .gt_font_bold {
  font-weight: bold;
}

#tsrmcdtdxr .gt_font_italic {
  font-style: italic;
}

#tsrmcdtdxr .gt_super {
  font-size: 65%;
}

#tsrmcdtdxr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#tsrmcdtdxr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#tsrmcdtdxr .gt_indent_1 {
  text-indent: 5px;
}

#tsrmcdtdxr .gt_indent_2 {
  text-indent: 10px;
}

#tsrmcdtdxr .gt_indent_3 {
  text-indent: 15px;
}

#tsrmcdtdxr .gt_indent_4 {
  text-indent: 20px;
}

#tsrmcdtdxr .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" style="table-layout: fixed;" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <colgroup>
    <col style="width:375px;">
    <col>
    <col>
    <col>
    <col>
    <col>
    <col>
  </colgroup>
  <thead>
    <tr class="gt_heading">
      <td colspan="7" class="gt_heading gt_title gt_font_normal" style=""><strong>Test of significance of BMI</strong></td>
    </tr>
    <tr class="gt_heading">
      <td colspan="7" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style="">From LDL model with BMI * statin interaction</td>
    </tr>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="term">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="df.residual">df.residual</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rss">rss</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="df">df</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sumsq">sumsq</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="statistic">statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p.value">p.value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="term" class="gt_row gt_left">LDL ~ statins + age + nonwhite + drinkany + smoking</td>
<td headers="df.residual" class="gt_row gt_right">2739</td>
<td headers="rss" class="gt_row gt_right">3725955</td>
<td headers="df" class="gt_row gt_right"></td>
<td headers="sumsq" class="gt_row gt_right"></td>
<td headers="statistic" class="gt_row gt_right"></td>
<td headers="p.value" class="gt_row gt_right"></td></tr>
    <tr><td headers="term" class="gt_row gt_left">LDL ~ BMIc * statins + age + nonwhite + drinkany + smoking</td>
<td headers="df.residual" class="gt_row gt_right">2737</td>
<td headers="rss" class="gt_row gt_right">3707501</td>
<td headers="df" class="gt_row gt_right">2</td>
<td headers="sumsq" class="gt_row gt_right">18454.31</td>
<td headers="statistic" class="gt_row gt_right">6.812</td>
<td headers="p.value" class="gt_row gt_right">0.001</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
</section>
<section id="overall-test" class="level3">
<h3 class="anchored" data-anchor-id="overall-test">Overall Test</h3>
<p>Under the null hypothesis, <span class="math inline">\(SSR/\sigma^2 \sim \chi^2_p\)</span> and <span class="math inline">\(SSE/\sigma^2 \sim \chi^2_{n-(p+1)}\)</span> are independent.</p>
<p>Therefore we have <span class="math display">\[F = \frac{SSR/p}{SSE/[n-(p+1)]} = \frac{MSR}{MSE} \stackrel{H_0}{\sim} F_{p,n-p-1}\]</span></p>
<p>We note that this is reported automatically in a <code>lm()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>overall.test <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(<span class="fu">anova</span>(<span class="fu">lm</span>(<span class="at">data =</span> hers, LDL <span class="sc">~</span> BMI <span class="sc">+</span> age)))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gt</span>(overall.test) <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="fu">md</span>(<span class="st">"**Overall test**"</span>),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">subtitle =</span> <span class="fu">md</span>(<span class="st">"Model of LDL with BMI and age"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sub_missing</span>(<span class="at">missing_text =</span> <span class="st">''</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">c</span>(<span class="st">'statistic'</span>, <span class="st">'p.value'</span>), <span class="at">decimals =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(<span class="at">table.align=</span><span class="st">'left'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="zdcdjkmixc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#zdcdjkmixc table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#zdcdjkmixc thead, #zdcdjkmixc tbody, #zdcdjkmixc tfoot, #zdcdjkmixc tr, #zdcdjkmixc td, #zdcdjkmixc th {
  border-style: none;
}

#zdcdjkmixc p {
  margin: 0;
  padding: 0;
}

#zdcdjkmixc .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: 0;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zdcdjkmixc .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#zdcdjkmixc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zdcdjkmixc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zdcdjkmixc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zdcdjkmixc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zdcdjkmixc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zdcdjkmixc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zdcdjkmixc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zdcdjkmixc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zdcdjkmixc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zdcdjkmixc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zdcdjkmixc .gt_spanner_row {
  border-bottom-style: hidden;
}

#zdcdjkmixc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#zdcdjkmixc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zdcdjkmixc .gt_from_md > :first-child {
  margin-top: 0;
}

#zdcdjkmixc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zdcdjkmixc .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zdcdjkmixc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#zdcdjkmixc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#zdcdjkmixc .gt_row_group_first td {
  border-top-width: 2px;
}

#zdcdjkmixc .gt_row_group_first th {
  border-top-width: 2px;
}

#zdcdjkmixc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zdcdjkmixc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#zdcdjkmixc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#zdcdjkmixc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zdcdjkmixc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zdcdjkmixc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zdcdjkmixc .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#zdcdjkmixc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zdcdjkmixc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zdcdjkmixc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zdcdjkmixc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zdcdjkmixc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zdcdjkmixc .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zdcdjkmixc .gt_left {
  text-align: left;
}

#zdcdjkmixc .gt_center {
  text-align: center;
}

#zdcdjkmixc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zdcdjkmixc .gt_font_normal {
  font-weight: normal;
}

#zdcdjkmixc .gt_font_bold {
  font-weight: bold;
}

#zdcdjkmixc .gt_font_italic {
  font-style: italic;
}

#zdcdjkmixc .gt_super {
  font-size: 65%;
}

#zdcdjkmixc .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#zdcdjkmixc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#zdcdjkmixc .gt_indent_1 {
  text-indent: 5px;
}

#zdcdjkmixc .gt_indent_2 {
  text-indent: 10px;
}

#zdcdjkmixc .gt_indent_3 {
  text-indent: 15px;
}

#zdcdjkmixc .gt_indent_4 {
  text-indent: 20px;
}

#zdcdjkmixc .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="6" class="gt_heading gt_title gt_font_normal" style=""><strong>Overall test</strong></td>
    </tr>
    <tr class="gt_heading">
      <td colspan="6" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style="">Model of LDL with BMI and age</td>
    </tr>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="term">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="df">df</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sumsq">sumsq</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="meansq">meansq</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="statistic">statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p.value">p.value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="term" class="gt_row gt_left">BMI</td>
<td headers="df" class="gt_row gt_right">1</td>
<td headers="sumsq" class="gt_row gt_right">14446.022</td>
<td headers="meansq" class="gt_row gt_right">14446.022</td>
<td headers="statistic" class="gt_row gt_right">10.155</td>
<td headers="p.value" class="gt_row gt_right">0.001</td></tr>
    <tr><td headers="term" class="gt_row gt_left">age</td>
<td headers="df" class="gt_row gt_right">1</td>
<td headers="sumsq" class="gt_row gt_right">7567.195</td>
<td headers="meansq" class="gt_row gt_right">7567.195</td>
<td headers="statistic" class="gt_row gt_right">5.320</td>
<td headers="p.value" class="gt_row gt_right">0.021</td></tr>
    <tr><td headers="term" class="gt_row gt_left">Residuals</td>
<td headers="df" class="gt_row gt_right">2744</td>
<td headers="sumsq" class="gt_row gt_right">3903361.455</td>
<td headers="meansq" class="gt_row gt_right">1422.508</td>
<td headers="statistic" class="gt_row gt_right"></td>
<td headers="p.value" class="gt_row gt_right"></td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>We can interpret the entries above in the <code>sumsq</code> column as <span class="math inline">\(SSR(BMI)\)</span> and then <span class="math inline">\(SSR(age|BMI)\)</span>. These are called the “extra sums of squares” contributed by each variable, and sometimes called the “type 1 sums of squares” (no relation to Type 1 error, but more of a historical idiosyncrasy as a result of how old software [either SAS or S or S-plus] printed these out).</p>
<p><span class="math display">\[F = \frac{(14446 + 7567)/2}{3903361/2744} = 7.74\]</span></p>
<p>Under <span class="math inline">\(H_0\)</span>, <span class="math inline">\(F \sim F_{2, 2744}\)</span>, yielding <span class="math inline">\(p = 0.0004458\)</span>.</p>
<p>We reject the null hypothesis at <span class="math inline">\(\alpha = 0.05\)</span> and conclude that at least one of <span class="math inline">\(\beta_1\)</span> or <span class="math inline">\(\beta_2\)</span> is not equal to zero.</p>
<p>One should note that the above table is one of the places in which order matters because each <span class="math inline">\(SSR\)</span> is conditional on the inclusion of the previously listed variables.</p>
</section>
</section>
<section id="wald-tests" class="level2">
<h2 class="anchored" data-anchor-id="wald-tests">Wald Tests</h2>
<p>For testing individual coefficients <span class="math inline">\((H_0: \beta_j = 0\)</span> vs <span class="math inline">\(H_1: \beta_j \neq 0\)</span>) we can also use the conventional Wald test. To construct the test statistic, consider that</p>
<p><span class="math display">\[\hat \beta_j \sim \mathcal N(\beta_j, \sigma^2) D_{jj} \quad \text{ and } \quad
\frac{\hat{\text{Var}} (\hat \beta_j)}{\sigma^2 D_{jj}} \sim \frac{\chi^2_{n-p-1}}{(n-p-1)}.\]</span></p>
<p>Note that if <span class="math inline">\(Z \sim \mathcal N(0,1)\)</span> and <span class="math inline">\(S \sim \chi^2_d\)</span> and <span class="math inline">\(Z \perp\!\!\!\perp S\)</span> then <span class="math inline">\(\frac{Z}{\sqrt{S/d}} \sim t_d\)</span>.</p>
<p><span class="math display">\[\left( \frac{\hat \beta_j - \beta_j}{\sqrt{\sigma^2 D_{jj}}} \right) \biggr /
\left( \sqrt{\frac{\widehat{\text{Var}}(\hat \beta_j)}{\sigma^2D_{jj}}} \right) = \underbrace{\boxed{\frac{\hat \beta_j - \beta_j}{\sqrt{\widehat{\text{Var}}(\hat \beta_j)}}}}_{\text{this should look like a t-statistic}} \stackrel{H_0}{\sim} t_{n-p-1}\]</span></p>
<p>It should be noted that a <span class="math inline">\(t^2\)</span> value where <span class="math inline">\(t\)</span> is a <span class="math inline">\(t\)</span>-statistic follows an <span class="math inline">\(F\)</span>-distribution. This implies that in the case of testing a single coefficient, the <span class="math inline">\(t\)</span>-test and the <span class="math inline">\(F\)</span>-test give the exact same results.</p>
<p>In the <code>summary()</code> function, the <span class="math inline">\(p\)</span>-values shown will be from <span class="math inline">\(t\)</span>-tests for each <span class="math inline">\(\beta_j\)</span>, while the <span class="math inline">\(F\)</span>-statistic shown is for the overall model.</p>
<p><span class="math display">\[E(LDL_i) = \beta_0 + \beta_1 BMI_i + \beta_2 Age_i\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>wald.test <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(<span class="fu">lm</span>(<span class="at">data =</span> hers, LDL <span class="sc">~</span> BMI <span class="sc">+</span> age))</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gt</span>(wald.test) <span class="sc">|&gt;</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>               <span class="fu">md</span>(<span class="st">"**Individual coefficient Wald test**"</span>),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">subtitle =</span> <span class="st">"Test of BMI in model of LDL with age already included"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">decimals =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(<span class="at">table.align=</span><span class="st">'left'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="yfubqpqpby" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#yfubqpqpby table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#yfubqpqpby thead, #yfubqpqpby tbody, #yfubqpqpby tfoot, #yfubqpqpby tr, #yfubqpqpby td, #yfubqpqpby th {
  border-style: none;
}

#yfubqpqpby p {
  margin: 0;
  padding: 0;
}

#yfubqpqpby .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: 0;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#yfubqpqpby .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#yfubqpqpby .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#yfubqpqpby .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#yfubqpqpby .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yfubqpqpby .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yfubqpqpby .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yfubqpqpby .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#yfubqpqpby .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#yfubqpqpby .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#yfubqpqpby .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#yfubqpqpby .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#yfubqpqpby .gt_spanner_row {
  border-bottom-style: hidden;
}

#yfubqpqpby .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#yfubqpqpby .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#yfubqpqpby .gt_from_md > :first-child {
  margin-top: 0;
}

#yfubqpqpby .gt_from_md > :last-child {
  margin-bottom: 0;
}

#yfubqpqpby .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#yfubqpqpby .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#yfubqpqpby .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#yfubqpqpby .gt_row_group_first td {
  border-top-width: 2px;
}

#yfubqpqpby .gt_row_group_first th {
  border-top-width: 2px;
}

#yfubqpqpby .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yfubqpqpby .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#yfubqpqpby .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#yfubqpqpby .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yfubqpqpby .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yfubqpqpby .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#yfubqpqpby .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#yfubqpqpby .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#yfubqpqpby .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yfubqpqpby .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yfubqpqpby .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yfubqpqpby .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yfubqpqpby .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yfubqpqpby .gt_left {
  text-align: left;
}

#yfubqpqpby .gt_center {
  text-align: center;
}

#yfubqpqpby .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#yfubqpqpby .gt_font_normal {
  font-weight: normal;
}

#yfubqpqpby .gt_font_bold {
  font-weight: bold;
}

#yfubqpqpby .gt_font_italic {
  font-style: italic;
}

#yfubqpqpby .gt_super {
  font-size: 65%;
}

#yfubqpqpby .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#yfubqpqpby .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#yfubqpqpby .gt_indent_1 {
  text-indent: 5px;
}

#yfubqpqpby .gt_indent_2 {
  text-indent: 10px;
}

#yfubqpqpby .gt_indent_3 {
  text-indent: 15px;
}

#yfubqpqpby .gt_indent_4 {
  text-indent: 20px;
}

#yfubqpqpby .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="5" class="gt_heading gt_title gt_font_normal" style=""><strong>Individual coefficient Wald test</strong></td>
    </tr>
    <tr class="gt_heading">
      <td colspan="5" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style="">Test of BMI in model of LDL with age already included</td>
    </tr>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="term">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="estimate">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="std.error">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="statistic">statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p.value">p.value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="term" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_right">151.443</td>
<td headers="std.error" class="gt_row gt_right">8.774</td>
<td headers="statistic" class="gt_row gt_right">17.260</td>
<td headers="p.value" class="gt_row gt_right">0.000</td></tr>
    <tr><td headers="term" class="gt_row gt_left">BMI</td>
<td headers="estimate" class="gt_row gt_right">0.367</td>
<td headers="std.error" class="gt_row gt_right">0.132</td>
<td headers="statistic" class="gt_row gt_right">2.778</td>
<td headers="p.value" class="gt_row gt_right">0.006</td></tr>
    <tr><td headers="term" class="gt_row gt_left">age</td>
<td headers="estimate" class="gt_row gt_right">−0.253</td>
<td headers="std.error" class="gt_row gt_right">0.110</td>
<td headers="statistic" class="gt_row gt_right">−2.306</td>
<td headers="p.value" class="gt_row gt_right">0.021</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><span class="math inline">\(T = 0.366/0.132 = 2.78 \quad p = 0.0006\)</span></p>
<p>This Wald testing strategy extends to testing groups of cofficients</p>
<p><span class="math display">\[Y = X_1 \beta_1 + X_2 \beta_2 + \epsilon\]</span></p>
<p>where <span class="math inline">\(\beta_1\)</span> is <span class="math inline">\(q \times 1\)</span> and <span class="math inline">\(\beta_2\)</span> is <span class="math inline">\((p + 1 - q) \times 1\)</span>.</p>
<p><span class="math display">\[H_0: \beta_1 = 0\]</span> <span class="math display">\[H_1: \beta_1 \neq 0\]</span></p>
<p>The multivariate Wald test statistic is <span class="math display">\[W = \hat \beta_1' \left[ \widehat{\text{Var}}(\hat \beta_1 ) \right]^{-1}  \hat \beta_1\]</span></p>
<p>Under the null,</p>
<ul>
<li><span class="math inline">\((1/q)W \sim F_{q,n-p-1}\)</span></li>
<li>Asymptotically, <span class="math inline">\(W \sim \chi_q^2\)</span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>wald.test.group <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(lm.ldl.interact)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gt</span>(wald.test.group) <span class="sc">|&gt;</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">md</span>(<span class="st">"**LDL model with BMI * statin interaction**"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">decimals =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(<span class="at">table.align=</span><span class="st">'left'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="mhzzoikkqh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mhzzoikkqh table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mhzzoikkqh thead, #mhzzoikkqh tbody, #mhzzoikkqh tfoot, #mhzzoikkqh tr, #mhzzoikkqh td, #mhzzoikkqh th {
  border-style: none;
}

#mhzzoikkqh p {
  margin: 0;
  padding: 0;
}

#mhzzoikkqh .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: 0;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mhzzoikkqh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mhzzoikkqh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mhzzoikkqh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mhzzoikkqh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mhzzoikkqh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mhzzoikkqh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mhzzoikkqh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mhzzoikkqh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mhzzoikkqh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mhzzoikkqh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mhzzoikkqh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mhzzoikkqh .gt_spanner_row {
  border-bottom-style: hidden;
}

#mhzzoikkqh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mhzzoikkqh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mhzzoikkqh .gt_from_md > :first-child {
  margin-top: 0;
}

#mhzzoikkqh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mhzzoikkqh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mhzzoikkqh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mhzzoikkqh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mhzzoikkqh .gt_row_group_first td {
  border-top-width: 2px;
}

#mhzzoikkqh .gt_row_group_first th {
  border-top-width: 2px;
}

#mhzzoikkqh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mhzzoikkqh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mhzzoikkqh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mhzzoikkqh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mhzzoikkqh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mhzzoikkqh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mhzzoikkqh .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mhzzoikkqh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mhzzoikkqh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mhzzoikkqh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mhzzoikkqh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mhzzoikkqh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mhzzoikkqh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mhzzoikkqh .gt_left {
  text-align: left;
}

#mhzzoikkqh .gt_center {
  text-align: center;
}

#mhzzoikkqh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mhzzoikkqh .gt_font_normal {
  font-weight: normal;
}

#mhzzoikkqh .gt_font_bold {
  font-weight: bold;
}

#mhzzoikkqh .gt_font_italic {
  font-style: italic;
}

#mhzzoikkqh .gt_super {
  font-size: 65%;
}

#mhzzoikkqh .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mhzzoikkqh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mhzzoikkqh .gt_indent_1 {
  text-indent: 5px;
}

#mhzzoikkqh .gt_indent_2 {
  text-indent: 10px;
}

#mhzzoikkqh .gt_indent_3 {
  text-indent: 15px;
}

#mhzzoikkqh .gt_indent_4 {
  text-indent: 20px;
}

#mhzzoikkqh .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border" style=""><strong>LDL model with BMI * statin interaction</strong></td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="term">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="estimate">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="std.error">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="statistic">statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p.value">p.value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="term" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_right">162.405</td>
<td headers="std.error" class="gt_row gt_right">7.583</td>
<td headers="statistic" class="gt_row gt_right">21.416</td>
<td headers="p.value" class="gt_row gt_right">0.000</td></tr>
    <tr><td headers="term" class="gt_row gt_left">BMIc</td>
<td headers="estimate" class="gt_row gt_right">0.582</td>
<td headers="std.error" class="gt_row gt_right">0.160</td>
<td headers="statistic" class="gt_row gt_right">3.636</td>
<td headers="p.value" class="gt_row gt_right">0.000</td></tr>
    <tr><td headers="term" class="gt_row gt_left">statinsyes</td>
<td headers="estimate" class="gt_row gt_right">−16.253</td>
<td headers="std.error" class="gt_row gt_right">1.469</td>
<td headers="statistic" class="gt_row gt_right">−11.066</td>
<td headers="p.value" class="gt_row gt_right">0.000</td></tr>
    <tr><td headers="term" class="gt_row gt_left">age</td>
<td headers="estimate" class="gt_row gt_right">−0.173</td>
<td headers="std.error" class="gt_row gt_right">0.111</td>
<td headers="statistic" class="gt_row gt_right">−1.563</td>
<td headers="p.value" class="gt_row gt_right">0.118</td></tr>
    <tr><td headers="term" class="gt_row gt_left">nonwhiteyes</td>
<td headers="estimate" class="gt_row gt_right">4.073</td>
<td headers="std.error" class="gt_row gt_right">2.275</td>
<td headers="statistic" class="gt_row gt_right">1.790</td>
<td headers="p.value" class="gt_row gt_right">0.074</td></tr>
    <tr><td headers="term" class="gt_row gt_left">drinkanyyes</td>
<td headers="estimate" class="gt_row gt_right">−2.075</td>
<td headers="std.error" class="gt_row gt_right">1.467</td>
<td headers="statistic" class="gt_row gt_right">−1.415</td>
<td headers="p.value" class="gt_row gt_right">0.157</td></tr>
    <tr><td headers="term" class="gt_row gt_left">smokingyes</td>
<td headers="estimate" class="gt_row gt_right">3.110</td>
<td headers="std.error" class="gt_row gt_right">2.167</td>
<td headers="statistic" class="gt_row gt_right">1.435</td>
<td headers="p.value" class="gt_row gt_right">0.151</td></tr>
    <tr><td headers="term" class="gt_row gt_left">BMIc:statinsyes</td>
<td headers="estimate" class="gt_row gt_right">−0.702</td>
<td headers="std.error" class="gt_row gt_right">0.269</td>
<td headers="statistic" class="gt_row gt_right">−2.606</td>
<td headers="p.value" class="gt_row gt_right">0.009</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>In this scenario, <span class="math inline">\(H_0: \beta_2 - \beta_8 = 0\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Generic function for a Wald test from the output of lm()</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>waldTest <span class="ot">&lt;-</span> <span class="cf">function</span>(fit, vec, <span class="at">digits=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>)) {</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  beta     <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit)[vec]</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  varMat   <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit)<span class="sc">$</span>cov.unscaled[vec,vec] <span class="sc">*</span> (<span class="fu">summary</span>(fit)<span class="sc">$</span>sigma<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  testStat <span class="ot">&lt;-</span> <span class="fu">t</span>(beta) <span class="sc">%*%</span> <span class="fu">solve</span>(varMat) <span class="sc">%*%</span> beta </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  pVal     <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pchisq</span>(testStat, <span class="fu">length</span>(vec))</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  value    <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">Fstat =</span> <span class="fu">round</span>(testStat, <span class="at">digits=</span>digits[<span class="dv">1</span>]),</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">p =</span> <span class="fu">round</span>(pVal, <span class="at">digits=</span>digits[<span class="dv">2</span>]))</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(value)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="fu">waldTest</span>(lm.ldl.interact, <span class="at">vec =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">8</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Fstat       p 
13.6200  0.0011 </code></pre>
</div>
</div>
</section>
<section id="testing-general-linear-hypotheses" class="level2">
<h2 class="anchored" data-anchor-id="testing-general-linear-hypotheses">Testing general linear hypotheses</h2>
<p>Suppose we are interested in testing linear combinations of the regression coefficients. For example, we may be interested in testing</p>
<p><span class="math display">\[H_0: \beta_i = \beta_j\]</span></p>
<p>equivalently <span class="math inline">\(H_0: \beta_i - \beta_j = 0\)</span>.</p>
<p>Such hypotheses can be expressed as <span class="math inline">\(H_0: C \beta = 0\)</span>.</p>
<p>Where <span class="math inline">\(C\)</span> is an <span class="math inline">\(r \times (p+1)\)</span> matrix of linearly independent contrasts with <span class="math inline">\(r\)</span> the number of restrictions imposed by the null.</p>
<p>For example, consider the model <span class="math display">\[Y_i = \beta_0 + \beta_1 x_{i1} + \beta_2 x_{i2} + \beta_3 x_{i3} + \epsilon_i,\]</span></p>
<p>and testing the hypothesis <span class="math display">\[H_i : \beta_1 = 0, \beta_2 = \beta_3\]</span></p>
<p>This could also be written as <span class="math display">\[\left( \begin{array}{c} \beta_1 \\ \beta_2 - \beta_3 \end{array} \right) =
\left( \begin{array}{c} 0 \\ 0 \end{array} \right)\]</span></p>
<p>This null hypothesis is equivalent to <span class="math display">\[H_0: \left( \begin{array}{cccc} 0 &amp; 1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 1 &amp; -1 \end{array} \right)\beta = 0\]</span> were <span class="math inline">\(\beta = (\beta_0, \beta_1, \beta_2, \beta_3)'\)</span>.</p>
<p>We can obtain the <span class="vocab">reduced model</span> by solving <span class="math inline">\(C\beta\)</span> for <span class="math inline">\(r\)</span> of the regression coefficients in terms of the remaining <span class="math inline">\(p+1-r\)</span> regression coefficients. Substituting these values into the full model will yield a reduced model under the null hypothesis,</p>
<p><span class="math display">\[Y = Z \gamma + \epsilon,\]</span></p>
<p>where <span class="math inline">\(\dim(Z) = n \times (p+1 -r)\)</span> matrix and <span class="math inline">\(\dim(\gamma) = (p + 1 - r) \times 1\)</span> vector of regression coefficients.</p>
<p>The residual SS for this reduced model is <span class="math display">\[SSE(RM) = y'y - \hat\gamma' Z'y \quad \quad (n - p - 1 + r \, \text{ degrees of freedom})\]</span></p>
<p><span class="math inline">\(SSR(\text{Full Model}) - SSR(\text{Reduced Model})\)</span> is called the <em>sum of squares due to the hypothesis</em> <span class="math inline">\(C\beta=0\)</span>.</p>
<p>We can test this hypothesis using <span class="math display">\[F = \frac{(SSR(FM)-SSR(RM))/r}{MSE} \stackrel{H_0}{\sim} F_{r,n-p-1}.\]</span></p>
<section id="example-with-hers-data" class="level4">
<h4 class="anchored" data-anchor-id="example-with-hers-data">Example with HERS data</h4>
<p>Consider using the physical activity score (1-5):</p>
<table class="table">
<thead>
<tr class="header">
<th>Physact</th>
<th>Activity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Much less active</td>
</tr>
<tr class="even">
<td>2</td>
<td>Somewhat less active</td>
</tr>
<tr class="odd">
<td>3</td>
<td>About as active</td>
</tr>
<tr class="even">
<td>4</td>
<td>Somewhat more active</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Much more active</td>
</tr>
</tbody>
</table>
<p>An ANOVA model for glucose level regressed on physical activity is</p>
<p><span class="math display">\[E(glucose_i) = \beta_0 + \beta_1D_{i1} + \beta_2D_{i2} + \beta_3D_{i3} + \beta_4 D_{i4}\]</span></p>
<p>Question: For the purposes of predicting glucose level, is the cruder physical activity categorization below adequate?</p>
<table class="table">
<thead>
<tr class="header">
<th>Collapsed Physact</th>
<th>Activity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Less active</td>
</tr>
<tr class="even">
<td>2</td>
<td>About as active</td>
</tr>
<tr class="odd">
<td>3</td>
<td>More active</td>
</tr>
</tbody>
</table>
<p>Recall the full model is</p>
<p><span class="math display">\[E(glucose_i) = \beta_0 + \beta_1D_{i1} + \beta_2D_{i2} + \beta_3D_{i3} + \beta_4 D_{i4}\]</span></p>
<p>and this question corresponds to the null hypothesis .</p>
<p>Remember that we can also write <span class="math inline">\(H_0\)</span> as <span class="math inline">\(\beta_1 - \beta_2 = 0, \beta_4 = 0\)</span>. We can think about this as having solved for <span class="math inline">\(\beta_1\)</span> in terms of <span class="math inline">\(\beta_2\)</span> or vice-versa.</p>
<p><span class="math display">\[H_0: \beta_1 = \beta_2, \beta_4 = 0\]</span></p>
<p>and the reduced model <span class="math display">\[E(glucose_i) = \beta_0 + \beta_1(D_{i1} + D_{i2}) + \beta_3D_{i3}\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>lm.glucose.pa <span class="ot">&lt;-</span> <span class="fu">lm</span>(glucose <span class="sc">~</span> <span class="fu">factor</span>(physact), <span class="at">data =</span> hers)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>pa.test.fine <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(<span class="fu">anova</span>(lm.glucose.pa))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">gt</span>(pa.test.fine) <span class="sc">|&gt;</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">tab_header</span>(<span class="at">title =</span> </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>               <span class="fu">md</span>(<span class="st">"**Overall test of 5-level physical activity**"</span>),</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">subtitle =</span> <span class="st">"Model of glucose with 5 PA categories"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">decimals =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(<span class="at">table.align=</span><span class="st">'left'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="bzjxeiukdd" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#bzjxeiukdd table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#bzjxeiukdd thead, #bzjxeiukdd tbody, #bzjxeiukdd tfoot, #bzjxeiukdd tr, #bzjxeiukdd td, #bzjxeiukdd th {
  border-style: none;
}

#bzjxeiukdd p {
  margin: 0;
  padding: 0;
}

#bzjxeiukdd .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: 0;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#bzjxeiukdd .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#bzjxeiukdd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#bzjxeiukdd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#bzjxeiukdd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bzjxeiukdd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bzjxeiukdd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bzjxeiukdd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#bzjxeiukdd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#bzjxeiukdd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#bzjxeiukdd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#bzjxeiukdd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#bzjxeiukdd .gt_spanner_row {
  border-bottom-style: hidden;
}

#bzjxeiukdd .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#bzjxeiukdd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#bzjxeiukdd .gt_from_md > :first-child {
  margin-top: 0;
}

#bzjxeiukdd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#bzjxeiukdd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#bzjxeiukdd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#bzjxeiukdd .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#bzjxeiukdd .gt_row_group_first td {
  border-top-width: 2px;
}

#bzjxeiukdd .gt_row_group_first th {
  border-top-width: 2px;
}

#bzjxeiukdd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bzjxeiukdd .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#bzjxeiukdd .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#bzjxeiukdd .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bzjxeiukdd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bzjxeiukdd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#bzjxeiukdd .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#bzjxeiukdd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#bzjxeiukdd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bzjxeiukdd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bzjxeiukdd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bzjxeiukdd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bzjxeiukdd .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bzjxeiukdd .gt_left {
  text-align: left;
}

#bzjxeiukdd .gt_center {
  text-align: center;
}

#bzjxeiukdd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#bzjxeiukdd .gt_font_normal {
  font-weight: normal;
}

#bzjxeiukdd .gt_font_bold {
  font-weight: bold;
}

#bzjxeiukdd .gt_font_italic {
  font-style: italic;
}

#bzjxeiukdd .gt_super {
  font-size: 65%;
}

#bzjxeiukdd .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#bzjxeiukdd .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#bzjxeiukdd .gt_indent_1 {
  text-indent: 5px;
}

#bzjxeiukdd .gt_indent_2 {
  text-indent: 10px;
}

#bzjxeiukdd .gt_indent_3 {
  text-indent: 15px;
}

#bzjxeiukdd .gt_indent_4 {
  text-indent: 20px;
}

#bzjxeiukdd .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="6" class="gt_heading gt_title gt_font_normal" style=""><strong>Overall test of 5-level physical activity</strong></td>
    </tr>
    <tr class="gt_heading">
      <td colspan="6" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style="">Model of glucose with 5 PA categories</td>
    </tr>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="term">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="df">df</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sumsq">sumsq</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="meansq">meansq</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="statistic">statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p.value">p.value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="term" class="gt_row gt_left">factor(physact)</td>
<td headers="df" class="gt_row gt_right">4.0</td>
<td headers="sumsq" class="gt_row gt_right">87,696.5</td>
<td headers="meansq" class="gt_row gt_right">21,924.1</td>
<td headers="statistic" class="gt_row gt_right">16.5</td>
<td headers="p.value" class="gt_row gt_right">0.0</td></tr>
    <tr><td headers="term" class="gt_row gt_left">Residuals</td>
<td headers="df" class="gt_row gt_right">2,758.0</td>
<td headers="sumsq" class="gt_row gt_right">3,662,765.0</td>
<td headers="meansq" class="gt_row gt_right">1,328.1</td>
<td headers="statistic" class="gt_row gt_right">NA</td>
<td headers="p.value" class="gt_row gt_right">NA</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>hers<span class="sc">$</span>collapsed_physact <span class="ot">&lt;-</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">case_when</span>(hers<span class="sc">$</span>physact <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"much less active"</span>, <span class="st">'somewhat less active'</span>) <span class="sc">~</span> <span class="st">'less'</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>            hers<span class="sc">$</span>physact <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"much more active"</span>, <span class="st">'somewhat more active'</span>) <span class="sc">~</span> <span class="st">'more'</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>            <span class="cn">TRUE</span> <span class="sc">~</span> hers<span class="sc">$</span>physact)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>lm.glucose.pacoarse <span class="ot">&lt;-</span> <span class="fu">lm</span>(glucose <span class="sc">~</span> <span class="fu">factor</span>(collapsed_physact), <span class="at">data =</span> hers)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>pa.test.coarse <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(<span class="fu">anova</span>(lm.glucose.pacoarse))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="fu">gt</span>(pa.test.coarse) <span class="sc">|&gt;</span> </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">md</span>(<span class="st">"**Overall test of 3-level physical activity**"</span>),</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Model of glucose with 3 PA categories"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> df<span class="sc">:</span>meansq,</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">decimals=</span><span class="dv">0</span>) <span class="sc">|&gt;</span> </span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> statistic<span class="sc">:</span>p.value,</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">decimals=</span><span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(<span class="at">table.align =</span> <span class="st">'left'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="aqxggpgvpn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#aqxggpgvpn table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#aqxggpgvpn thead, #aqxggpgvpn tbody, #aqxggpgvpn tfoot, #aqxggpgvpn tr, #aqxggpgvpn td, #aqxggpgvpn th {
  border-style: none;
}

#aqxggpgvpn p {
  margin: 0;
  padding: 0;
}

#aqxggpgvpn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: 0;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#aqxggpgvpn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#aqxggpgvpn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#aqxggpgvpn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#aqxggpgvpn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#aqxggpgvpn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aqxggpgvpn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#aqxggpgvpn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#aqxggpgvpn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#aqxggpgvpn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#aqxggpgvpn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#aqxggpgvpn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#aqxggpgvpn .gt_spanner_row {
  border-bottom-style: hidden;
}

#aqxggpgvpn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#aqxggpgvpn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#aqxggpgvpn .gt_from_md > :first-child {
  margin-top: 0;
}

#aqxggpgvpn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#aqxggpgvpn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#aqxggpgvpn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#aqxggpgvpn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#aqxggpgvpn .gt_row_group_first td {
  border-top-width: 2px;
}

#aqxggpgvpn .gt_row_group_first th {
  border-top-width: 2px;
}

#aqxggpgvpn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#aqxggpgvpn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#aqxggpgvpn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#aqxggpgvpn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aqxggpgvpn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#aqxggpgvpn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#aqxggpgvpn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#aqxggpgvpn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#aqxggpgvpn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aqxggpgvpn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#aqxggpgvpn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#aqxggpgvpn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#aqxggpgvpn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#aqxggpgvpn .gt_left {
  text-align: left;
}

#aqxggpgvpn .gt_center {
  text-align: center;
}

#aqxggpgvpn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#aqxggpgvpn .gt_font_normal {
  font-weight: normal;
}

#aqxggpgvpn .gt_font_bold {
  font-weight: bold;
}

#aqxggpgvpn .gt_font_italic {
  font-style: italic;
}

#aqxggpgvpn .gt_super {
  font-size: 65%;
}

#aqxggpgvpn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#aqxggpgvpn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#aqxggpgvpn .gt_indent_1 {
  text-indent: 5px;
}

#aqxggpgvpn .gt_indent_2 {
  text-indent: 10px;
}

#aqxggpgvpn .gt_indent_3 {
  text-indent: 15px;
}

#aqxggpgvpn .gt_indent_4 {
  text-indent: 20px;
}

#aqxggpgvpn .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="6" class="gt_heading gt_title gt_font_normal" style=""><strong>Overall test of 3-level physical activity</strong></td>
    </tr>
    <tr class="gt_heading">
      <td colspan="6" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style="">Model of glucose with 3 PA categories</td>
    </tr>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="term">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="df">df</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sumsq">sumsq</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="meansq">meansq</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="statistic">statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p.value">p.value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="term" class="gt_row gt_left">factor(collapsed_physact)</td>
<td headers="df" class="gt_row gt_right">2</td>
<td headers="sumsq" class="gt_row gt_right">76,501</td>
<td headers="meansq" class="gt_row gt_right">38,250</td>
<td headers="statistic" class="gt_row gt_right">28.73</td>
<td headers="p.value" class="gt_row gt_right">0.00</td></tr>
    <tr><td headers="term" class="gt_row gt_left">Residuals</td>
<td headers="df" class="gt_row gt_right">2,760</td>
<td headers="sumsq" class="gt_row gt_right">3,673,961</td>
<td headers="meansq" class="gt_row gt_right">1,331</td>
<td headers="statistic" class="gt_row gt_right">NA</td>
<td headers="p.value" class="gt_row gt_right">NA</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>Our <span class="math inline">\(F\)</span>-test then becomes:</p>
<p><span class="math display">\[ \frac{(87,697 - 76,501)/2}{1330} = 4.21 \stackrel{H_0}{=} F_{2,2760} \, \, (p = 0.0149)\]</span></p>
<p>How would we get that p-value?</p>
<p>In our case we can run:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>F_stat <span class="ot">&lt;-</span> ((pa.test.fine<span class="sc">$</span>sumsq[[<span class="dv">1</span>]]<span class="sc">-</span>pa.test.coarse<span class="sc">$</span>sumsq[[<span class="dv">1</span>]])<span class="sc">/</span><span class="dv">2</span>) <span class="sc">/</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  pa.test.fine<span class="sc">$</span>meansq[[<span class="dv">2</span>]]</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(F_stat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.215159</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pf</span>( <span class="co"># the distribution function (cdf) of the F distribution </span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">q =</span> F_stat,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">df1 =</span> <span class="dv">2</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">df2 =</span> pa.test.fine<span class="sc">$</span>df[[<span class="dv">2</span>]],</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01486524</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare to the anova table p-value</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm.glucose.pacoarse, lm.glucose.pa) <span class="sc">|&gt;</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">md</span>(<span class="st">"**ANOVA table comparing the 5-level to 3-level model**"</span>),</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Glucose regressed on physical activity"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> df.residual<span class="sc">:</span>df,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">0</span>) <span class="sc">|&gt;</span> </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> statistic<span class="sc">:</span><span class="st">`</span><span class="at">p.value</span><span class="st">`</span>,</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="sxjjslmcdq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#sxjjslmcdq table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#sxjjslmcdq thead, #sxjjslmcdq tbody, #sxjjslmcdq tfoot, #sxjjslmcdq tr, #sxjjslmcdq td, #sxjjslmcdq th {
  border-style: none;
}

#sxjjslmcdq p {
  margin: 0;
  padding: 0;
}

#sxjjslmcdq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#sxjjslmcdq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#sxjjslmcdq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#sxjjslmcdq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#sxjjslmcdq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sxjjslmcdq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sxjjslmcdq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sxjjslmcdq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#sxjjslmcdq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#sxjjslmcdq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#sxjjslmcdq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#sxjjslmcdq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#sxjjslmcdq .gt_spanner_row {
  border-bottom-style: hidden;
}

#sxjjslmcdq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#sxjjslmcdq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#sxjjslmcdq .gt_from_md > :first-child {
  margin-top: 0;
}

#sxjjslmcdq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#sxjjslmcdq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#sxjjslmcdq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#sxjjslmcdq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#sxjjslmcdq .gt_row_group_first td {
  border-top-width: 2px;
}

#sxjjslmcdq .gt_row_group_first th {
  border-top-width: 2px;
}

#sxjjslmcdq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sxjjslmcdq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#sxjjslmcdq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#sxjjslmcdq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sxjjslmcdq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sxjjslmcdq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#sxjjslmcdq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#sxjjslmcdq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#sxjjslmcdq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sxjjslmcdq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sxjjslmcdq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sxjjslmcdq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sxjjslmcdq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sxjjslmcdq .gt_left {
  text-align: left;
}

#sxjjslmcdq .gt_center {
  text-align: center;
}

#sxjjslmcdq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#sxjjslmcdq .gt_font_normal {
  font-weight: normal;
}

#sxjjslmcdq .gt_font_bold {
  font-weight: bold;
}

#sxjjslmcdq .gt_font_italic {
  font-style: italic;
}

#sxjjslmcdq .gt_super {
  font-size: 65%;
}

#sxjjslmcdq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#sxjjslmcdq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#sxjjslmcdq .gt_indent_1 {
  text-indent: 5px;
}

#sxjjslmcdq .gt_indent_2 {
  text-indent: 10px;
}

#sxjjslmcdq .gt_indent_3 {
  text-indent: 15px;
}

#sxjjslmcdq .gt_indent_4 {
  text-indent: 20px;
}

#sxjjslmcdq .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="7" class="gt_heading gt_title gt_font_normal" style=""><strong>ANOVA table comparing the 5-level to 3-level model</strong></td>
    </tr>
    <tr class="gt_heading">
      <td colspan="7" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style="">Glucose regressed on physical activity</td>
    </tr>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="term">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="df.residual">df.residual</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rss">rss</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="df">df</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sumsq">sumsq</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="statistic">statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p.value">p.value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="term" class="gt_row gt_left">glucose ~ factor(collapsed_physact)</td>
<td headers="df.residual" class="gt_row gt_right">2,760</td>
<td headers="rss" class="gt_row gt_right">3,673,961</td>
<td headers="df" class="gt_row gt_right">NA</td>
<td headers="sumsq" class="gt_row gt_right">NA</td>
<td headers="statistic" class="gt_row gt_right">NA</td>
<td headers="p.value" class="gt_row gt_right">NA</td></tr>
    <tr><td headers="term" class="gt_row gt_left">glucose ~ factor(physact)</td>
<td headers="df.residual" class="gt_row gt_right">2,758</td>
<td headers="rss" class="gt_row gt_right">3,662,765</td>
<td headers="df" class="gt_row gt_right">2</td>
<td headers="sumsq" class="gt_row gt_right">11195.89</td>
<td headers="statistic" class="gt_row gt_right">4.215</td>
<td headers="p.value" class="gt_row gt_right">0.015</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<div class="cooltip">
<p>What is the multivariate Wald test for a general linear hypothesis?</p>
<p><span class="math display">\[H_0 : C\beta = 0\]</span></p>
<p>And thus <span class="math display">\[W = (C\hat \beta)'(\widehat{\text{Var}}(C\hat\beta))^{-1}(C\beta)\]</span> <span class="math display">\[ = (C\hat\beta)'[C \widehat{\text{Var}}(\hat\beta) C']^{-1}(C\hat\beta)\]</span> <span class="math display">\[ = (C\hat\beta)'[C \hat \sigma^2 (X'X)^{-1} C']^{-1} (C\hat\beta)\]</span></p>
<p>and <span class="math inline">\(W/r \sim F_{r,n-p-1}\)</span> or asymptotically <span class="math inline">\(W \sim \chi^2_r\)</span>.</p>
</div>
</section>
</section>
<section id="confidence-intervals" class="level2">
<h2 class="anchored" data-anchor-id="confidence-intervals">Confidence Intervals</h2>
<p>Recall that often we obtain CIs by inverting test statistics.</p>
<p>Thus we can construct a confidence interval for <span class="math inline">\(\beta_j\)</span> by inverting the univariate <span class="math inline">\(t\)</span>-test.</p>
<p>First, letting <span class="math inline">\(c\)</span> denote <span class="math inline">\(t_{n-p-1,1-\alpha/2}\)</span>, note that <span class="math display">\[P(-c &lt; \frac{\hat \beta_j - \beta_j}{\sigma(\hat \beta_j)} &lt; c) = 0.95\]</span></p>
<p><span class="math display">\[ \Longrightarrow (\hat \beta_j - c \times \sigma(\hat \beta_j) &lt; \beta_j &lt; \hat \beta_j + c \times \sigma(\hat \beta_j)) = 0.95\]</span></p>
<p><span class="math display">\[\hat \beta_j \pm t_{n - p -1, 1 - \alpha/2} \sqrt{\hat \sigma^2 D_{jj}}\]</span></p>
</section>
<section id="model-estimated-expected-value" class="level2">
<h2 class="anchored" data-anchor-id="model-estimated-expected-value">Model Estimated Expected Value</h2>
<p>A 100(1-<span class="math inline">\(\alpha)\)</span>% CI for <span class="math inline">\(\mu(x) = x'\beta\)</span> is <span class="math display">\[\hat \mu(x) \pm t_{n-p-1, 1-\alpha/2} \sqrt{\hat \sigma^2 x' (X' X)^{-1} x}\]</span></p>
<section id="prediction-intervals" class="level3">
<h3 class="anchored" data-anchor-id="prediction-intervals">Prediction Intervals</h3>
<p>A 100(1-<span class="math inline">\(\alpha\)</span>)% prediction interval for a single new observation with covariate values <span class="math inline">\(x_{new}\)</span> is constructed by noting that</p>
<p><span class="math display">\[y_{new} = x_{new}' \beta  + \varepsilon_{new}\]</span></p>
<p>and <span class="math inline">\(\text{Var}(\hat y_{new}) = \sigma^2 x_{new}' (X'X)^{-1}x_{new} + \sigma^2\)</span>. Then</p>
<p><span class="math display">\[\hat y_{new} \pm t_{n-p-1, 1 -\alpha} \sqrt{ \hat \sigma^2 \left(1 + x_{new}' (X'X)^{-1} x_{new}\right)}\]</span></p>
<p>where <span class="math inline">\(\hat y_{new} = x_{new}' \hat \beta\)</span>.</p>
<p>Thus the predictions for <span class="math inline">\(y_{new}\)</span> have have uncertainty both from the estimate of <span class="math inline">\(\hat \beta\)</span> and the estimated error variance <span class="math inline">\(\hat \sigma^2\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>lm.sbp.age <span class="ot">&lt;-</span> <span class="fu">lm</span>(SBP <span class="sc">~</span> age, <span class="at">data =</span> hers)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>pred_with_ci <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm.sbp.age, <span class="at">interval =</span> <span class="st">'confidence'</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>pred_with_pi <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm.sbp.age, <span class="at">interval =</span> <span class="st">'prediction'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in predict.lm(lm.sbp.age, interval = "prediction"): predictions on current data refer to _future_ responses</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>intervals <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(hers<span class="sc">$</span>age, pred_with_ci, pred_with_pi[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(intervals) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'age'</span>, <span class="st">'yhat'</span>, <span class="st">'lwr_ci'</span>, <span class="st">'upr_ci'</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                      <span class="st">'lwr_pi'</span>, <span class="st">'upr_pi'</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>intervals <span class="ot">&lt;-</span> intervals <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(age)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(intervals, <span class="fu">aes</span>(age)) <span class="sc">+</span> </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span> lwr_pi, <span class="at">ymax =</span> upr_pi, <span class="at">fill =</span> <span class="st">'prediction interval'</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span> lwr_ci, <span class="at">ymax =</span> upr_ci, <span class="at">fill =</span> <span class="st">'confidence interval'</span>), <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> yhat)) <span class="sc">+</span> </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">data =</span> hers, <span class="fu">aes</span>(age, SBP), <span class="at">size =</span> .<span class="dv">75</span>, <span class="at">width =</span> .<span class="dv">5</span>, <span class="at">height =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.15</span>) <span class="sc">+</span> </span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'prediction interval'</span> <span class="ot">=</span> <span class="st">'orange'</span>, <span class="st">'confidence interval'</span> <span class="ot">=</span> <span class="st">'cornflowerblue'</span>)) <span class="sc">+</span> </span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'SBP'</span>, <span class="at">fill =</span> <span class="st">'interval type'</span>) <span class="sc">+</span> </span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Regression Prediction and Confidence Intervals"</span>) <span class="sc">+</span> </span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'bottom'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week3_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Note that we have assumed <span class="math inline">\(\varepsilon \sim \mathcal N(0, \sigma^2)\)</span> to construct the prediction interval. If the error terms are not close to normal, then the prediction interval could be misleading. This is not the case for the interval for the expected value, which only requires approximate normality for <span class="math inline">\(\hat \beta_0\)</span> and <span class="math inline">\(\hat \beta_1\)</span>.</p>
</section>
</section>
<section id="r2-and-adjusted-r2" class="level2">
<h2 class="anchored" data-anchor-id="r2-and-adjusted-r2"><span class="math inline">\(R^2\)</span> and Adjusted <span class="math inline">\(R^2\)</span></h2>
<p><span class="math display">\[R^2 = 1 - \frac{SSE}{SST} = \frac{SSR}{SST}\]</span></p>
<p>The proportion of the total variation in <span class="math inline">\(Y_i\)</span> explained by <span class="math inline">\(X_i\)</span>.</p>
<p>Because <span class="math inline">\(0 \leq SSE \leq SST\)</span>, <span class="math inline">\(0 \leq R^2 \leq 1\)</span>.</p>
<p><span class="math inline">\(R^2\)</span> increases whenever new terms are added to the model.</p>
<p>Therefore for model comparison, most people often use a version of the <span class="math inline">\(R^2\)</span> that is adjusted for the number of predictors in the model. This is the <span class="vocab">adjusted</span> <span class="math inline">\(R^2\)</span>, defined as <span class="math display">\[R^2 = 1 - \left( \frac{n-1}{\text{Error df}} \right) \frac{SSE}{SST}  = 1 - \frac{MSE}{SST/(n-1)}\]</span></p>
<p>Using the MSE is essentially a penalization on wasting unused parameters since <span class="math display">\[MSE = \frac{\sum_{i=1}^n (x_i - \bar x_i)^2}{n - p - 1}.\]</span></p>
</section>
<section id="lab" class="level1">
<h1>Lab</h1>
<blockquote class="blockquote">
<p>“The only useful function of a statistician is to make predictions, and thus to provide the basis for action” <br> —William Edwards Demings, U.S. War Department, 1942</p>
</blockquote>
<blockquote class="blockquote">
<p>“Data analysis is detective work—almost an ideal example of seeking what might be relevant.” <br> —John W. Tukey, 1969</p>
</blockquote>
<p>One perspective is that statistics is really only good for two things:</p>
<ul>
<li>To make predictions</li>
<li>To explain — to generate understanding, to see associations, to describe.</li>
</ul>
<section id="variance-estimates-to-confidence-intervals" class="level2">
<h2 class="anchored" data-anchor-id="variance-estimates-to-confidence-intervals">Variance estimates to confidence intervals</h2>
<p>We know that if <span class="math inline">\(Z\)</span> is a random vector and <span class="math inline">\(A\)</span> is a matrix of constants, then</p>
<p><span class="math display">\[\text{Var}(AZ) = A \text{Var}(Z) A^T.\]</span></p>
<p>This implies that</p>
<p><span class="math display">\[\text{Var}(\hat \beta) = \text{Var}[(X^TX)^{-1} X^TY] = \sigma^2 (X^TX)^{-1}\]</span></p>
<p>This is a quadratic form. If we were in a scalar world with a variable <span class="math inline">\(a \in \mathbb R\)</span> and <span class="math inline">\(z\)</span> a random variable. Then <span class="math inline">\(\text{Var}(az) = a^2 \text{Var}(z)\)</span>. When we work with matrices, the square of a matrix is analogous to writing <span class="math inline">\(AA^T\)</span></p>
<p>Remember that <span class="math inline">\(\hat \beta = \underbrace{(X^TX)^{-1} X^T}y\)</span>.</p>
<p><span class="math display">\[\text{Var}(\beta) = \left( \begin{array}{cccc}
\text{Var}(\beta_1) &amp; \text{Cov}(\beta_1,\beta_2) &amp; ... &amp; ... \\
\text{Cov}(\beta_2, \beta_1) &amp; \text{Var}(\beta_2) &amp; ... &amp; ... \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots
\end{array}\right).\]</span></p>
<p><span class="math display">\[95\%CI(\hat \beta_j) = \hat \beta_j \pm t_{n-p-1, 1-\alpha/2} \hat \sigma \sqrt{[(X^TX)^{-1}]_{j,j}}.\]</span></p>
<p>But we can use the same idea to obtain variance and CI estimates for the prediction of a new/future observation <span class="math inline">\(x_{new}\)</span>. Given <span class="math inline">\(x_{new}\)</span> we can predict their mean response <span class="math inline">\(\mathbb E(\hat y|x_{new}) = x^T_{new}\hat \beta\)</span>.</p>
<p>Note that we cannot predict the response itself since we don’t know what <span class="math inline">\(\varepsilon_{new}\)</span> is.</p>
<p>When it comes to confidence intervals, we can indeed get two different types of intervals.</p>
<p><span class="math display">\[\text{Predicted mean response: } \quad \text{Var}(\hat{\mathbb E}(\hat y|x_{new})) =
\text{Var}(x_{new}^T \hat \beta) = \sigma^2 x^T_{new} (X^TX)^{-1} x_{new},\]</span></p>
<p>which gives the 95% confidence interval:</p>
<p><span class="math display">\[x_{new}^T \hat \beta \pm t_{n-p-1,1-\alpha/2} \hat \sigma \sqrt{x_{new}^T (X^TX)^{-1} x_{new}}.\]</span></p>
<p><span class="math display">\[\text{The predicted response: }
\quad \text{Var}(\hat y|x_{new}) = \text{Var}(x_{new}^T \hat \beta + \varepsilon_{new}) = \sigma^2 x_{new}^T (X^TX)^{-1}x_{new} + \sigma^2,\]</span></p>
<p>which gives the 95% <span class="vocab">prediction</span> interval:</p>
<p><span class="math display">\[x_{new}^T \hat \beta \pm t_{n-p-1, 1-\alpha/2} \hat \sigma \sqrt{1 + x_{new}^T(X^TX)^{-1}x_{new}}.\]</span></p>
<p>In general, we can’t predict <span class="math inline">\(y_new = \hat \beta_0 + \hat \beta_1 x_1 + ... + \varepsilon_{new}\)</span> because we don’t know <span class="math inline">\(\varepsilon_{new}\)</span>. However, we can predict <span class="math display">\[\text{Var}(\hat y_{new}|x_{new}) = \text{Var}(\hat \beta_0 + \hat \beta_1 x_1 + ...) + \underbrace{\text{Var}(\varepsilon_{new})}_{=0,\, \text{ by assumption}}.\]</span></p>
<p>Why should these values be <span class="math inline">\(t\)</span>-distributed? Because finite samples of the <span class="math inline">\(\beta\)</span> distributed <!-- notes to self: 
$F$-distributions are asymptotically $t$-distributed. 

$t$-distributions are asymptotically normally distributed. 

The Wald test uses \chi^2 distributions
--></p>
<p>Often we just write <span class="math inline">\(\mathbb E(y) = X\beta\)</span>, but this isn’t really the full model. It’s missing an assumption: <span class="math inline">\(\text{Var}(y) = \sigma^2I_n\)</span> where <span class="math inline">\(I_n\)</span> is the <span class="math inline">\(n \times n\)</span> identity matrix.</p>
<p>We get <span class="math inline">\(\hat \beta\)</span> often from either <span class="math inline">\(OLS\)</span> or <span class="math inline">\(MLE\)</span>, and we get the <span class="math inline">\(\hat \sigma^2\)</span> from the MSE.</p>
<p>Why do we care about these values? One way is to just say “center and spread” — but a more sophisticated way is to realize that these two statistics completely characterize a normal distribution.</p>
<p>The moment generating function says that <span class="math display">\[D(Y) = 1 + \mathbb Ey + \text{Var}(y) + \text{Skew}(y) + \text{Kurtosis}(y) + ...\]</span></p>
<p>Confidence intervals tell us what are the plausible range of model parameters.</p>
</section>
<section id="hypothesis-testing" class="level2">
<h2 class="anchored" data-anchor-id="hypothesis-testing">Hypothesis Testing</h2>
<p>Hypothesis testing is about having a hunch and seeing if we’re right.</p>
<p>For multiple linear regression, there are many options for testing the significance of predictor variables. These tests fall under two main categories: F tests and Wald tests. Both are asymptotically equivalent, so yield comparable results in hypothesis testing.</p>
<p>The F-test is looking at the variances. The Wald test is looking at the behavior of the means.</p>
<section id="f-tests-comparison-of-variances" class="level3">
<h3 class="anchored" data-anchor-id="f-tests-comparison-of-variances">F-tests (comparison of variances)</h3>
<p>Recall that</p>
<ul>
<li>SST (Total Sum of Squares) is a measure of the total variance in the outcome from the given sample.</li>
<li>SSR (Regression Sum of Squares) represents the total variance in the outcome explained by the regression model.</li>
<li>SSE (Sum of Squared Errors) represents the remaining total variance in the outcome that is not captured by the regression model. We use the SSE to estimate the true (unobserved) variance <span class="math inline">\(\sigma^2\)</span> of the residuals. Let <span class="math inline">\(\hat \sigma^2 = MSE = SSE/(n-p-1)\)</span> for a model with <span class="math inline">\(p\)</span> predictors and an intercept.</li>
</ul>
<p><span class="math display">\[SST \stackrel{def}{=} \sum_{i=1}^n (Y_i - \bar Y)^2 = \sum_{i=1}^n (\hat Y_i - \bar Y)^2 + \sum_{i=1}^n (Y_i - \hat Y_i)^2 \stackrel{def}{=} SSR + SST\]</span></p>
<p>The <span class="math inline">\(F\)</span>-tests are:</p>
<ol type="1">
<li>Test for no covariate effect <span class="math inline">\(H_0: \beta_1 = ... = \beta_p = 0\)</span></li>
</ol>
<p><span class="math display">\[F = \frac{SSR/p}{SSE/(n-p-1)} = \frac{SSR/p}{MSE} \sim F_{p,n-p-1}.\]</span> 2. Test for a single variable <span class="math inline">\(x_j\)</span>. <span class="math inline">\(H_0 : \beta_j = 0\)</span>.</p>
<p><span class="math display">\[F = \frac{[SSR - SSR(\text{model without } x_j)]/1}{SSE/(n-p-1)}\]</span> <span class="math display">\[ =
  \frac{SSR - SSR(\text{model without } x_j)}{MSE} \sim F_{1, n-p-1}.\]</span></p>
<ol start="3" type="1">
<li>Test for a group of <span class="math inline">\(r\)</span> variables. <span class="math inline">\(H_0: \beta_{j_1} = ... = \beta_{j_r} = 0\)</span>.</li>
</ol>
<p><span class="math display">\[F = \frac{[SSR - SSR(\text{model without } r \text{ variables})]/r}{SSE/(n-p-1)}\]</span> <span class="math display">\[ = \frac{[SSR - SSR(\text{model without } r \text{ variables})]/r}{MSE} \sim F_{1,n-p-1}.\]</span></p>
<ol start="4" type="1">
<li>Test of a general linear hypothesis, <span class="math inline">\(H_0: C\beta= 0\)</span> where <span class="math inline">\(C\)</span> is an <span class="math inline">\(r \times (p+1)\)</span> matrix of linearly independent contrasts. The test requires calculation of the sum of squares for the reduced model, where we parameterize according to the null hypothesis.</li>
</ol>
<p><span class="math display">\[F = \frac{(SSR - SSR(\text{reduced model}))/r}{MSE} \sim F_{r,n-p-1}\]</span></p>
<p>The MSE is from the full model.</p>
<p><strong>Note:</strong> the reduced model must be nested within the full model for us to use the <span class="math inline">\(F\)</span>-test.</p>
<div class="hottip">
<p>A great question is to look at this formula and say that the numerator is a marginal quantity, so why shouldn’t the denominator also be marginal?</p>
<p>One reason might be that if it were, the denominator would no longer have the same degrees of freedom as the numerator.</p>
<p>Another reason, arguably more important, is that this quantity would no longer be <span class="math inline">\(F\)</span>-distributed, and we really want to have a quantity with nice asymptotic distributional properties.</p>
</div>
<p>Let’s look at an example of situation 4:</p>
<p>The full model might be <span class="math display">\[\mathbb E(y) = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_3 x_3\]</span></p>
<p>And model 2 is given as <span class="math display">\[\mathbb E(y) = \gamma_0 + \gamma_1 x_1\]</span></p>
<p>Then</p>
<p><span class="math display">\[\left( \begin{array}{cccc} 0 &amp; 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 1 \end{array} \right) \left( \begin{array}{c} \beta_1 \\ \beta_2 \\ \beta_3 \\ \beta_4 \end{array} \right) = \left( \begin{array}{c} 0 \\ 0 \end{array} \right)\]</span></p>
<p>In general, when we say that the reduced model must be nested within the full model, what we’re saying is that the reduced model can be expressed as a linear constraint imposed on the full model.</p>
<p>For example, we might have a scenario where <span class="math inline">\(Age \in \{ 57, 58, 59 \}\)</span> and our reduced model is <span class="math display">\[y = \beta_0 + \beta_1 Age\]</span></p>
<p>And our full model is <span class="math display">\[y = \gamma_0 + \gamma_1 \mathbb 1(Age = 57) + \gamma_2 \mathbb 1(Age = 58) + \gamma_3 \mathbb 1 (Age = 59)\]</span></p>
<p>If we make a new variable that is <span class="math display">\[57 \mathbb 1(Age = 57) + 58 \mathbb 1(Age = 58) + 59 \mathbb 1 (Age = 59)\]</span>, and this recovers the original age variable.</p>
<div class="cooltip">
<p>The <span class="math inline">\(F\)</span>-test can be thought of as a cost-benefit ratio.</p>
</div>
</section>
</section>
<section id="wald-test-comparison-of-means" class="level2">
<h2 class="anchored" data-anchor-id="wald-test-comparison-of-means">Wald test (comparison of means)</h2>
<p>As we touched on in lecture, we can also consider an alternative hypothesis test formulation for linear regression—this will also help motivate the form of our confidence intervals below. Recall the following properties: For an <span class="math inline">\(r \times (p+1)\)</span> matrix <span class="math inline">\(C\)</span> and a random vector <span class="math inline">\(y\)</span>, then</p>
<p><span class="math display">\[\mathbb E(Cy) = C\mathbb E(y) \quad \text{and} \quad \text{Var}(Cy) = C\text{Var}(y)C^T\]</span></p>
<p>As we have shown previously, <span class="math display">\[\hat \beta \sim MVN_{p+1} (\beta, \sigma^2 C(X^TX)^{-1}C^T)\]</span></p>
<p>So, to test the general linear hypothesis <span class="math inline">\(H_0: C\beta = 0\)</span>, we have the following statistic (which generalizes the familiar univariate Wald statistic <span class="math inline">\(W = \hat \beta^2 / \widehat{\text{Var}}(\hat \beta) \sim \chi^2_1\)</span>, asypmptotically):</p>
<p><span class="math display">\[W = (C\hat \beta)^T\underbrace{[\hat \sigma^2 C(X^TX)^{-1}C^T]^{-1}}_{\text{variance of } C\beta}(C\hat \beta)\]</span></p>
<p>If we think of what we’d do in a standard intro stats class, we’d do one of two things.</p>
<ol type="1">
<li>We’d look at <span class="math inline">\(\hat \beta_1 / \hat \sigma(\hat \beta_1)\)</span>, which is <span class="math inline">\(t\)</span>-distributed.</li>
<li>Or we’d look in <span class="math inline">\(\hat \beta_1^2/\widehat{Var}(\hat \beta_1)\)</span> which is <span class="math inline">\(F\)</span>-distributed and asymptotically <span class="math inline">\(\chi^2\)</span> distributed.</li>
</ol>
<p>Then by properties of the <span class="math inline">\(F\)</span>-statistic, <span class="math inline">\(W/r \sim F_{r,n-p-1}\)</span>, and also asymptotically <span class="math inline">\(W \sim \chi_r^2\)</span>.</p>
</section>
<section id="additional-remarks" class="level2">
<h2 class="anchored" data-anchor-id="additional-remarks">Additional Remarks</h2>
<p>Note that the univariate Wald Statistic <span class="math inline">\(W = \hat \beta^2 / \widehat{\text{Var}}(\hat \beta) \sim \chi_1^2\)</span> is equivalent to the <span class="math inline">\(t\)</span>-test statistic</p>
<p><span class="math display">\[t_{obs} = \frac{\hat \beta_1}{s.e.(\hat\beta_1)} \sim t_{n-2,(1-\alpha/2)}.\]</span></p>
<p>While we will not go into this in detail, the theoretical motivation for all of these tests is that they are ratios of <span class="math inline">\(\chi^2\)</span>-distributed random variables that are scaled by their degrees of freedom, which in turn defines the <span class="math inline">\(F\)</span>-distribution.</p>
<p>The <span class="math inline">\(F\)</span>-test is valid if and only if the <span class="math inline">\(\chi^2\)</span> assumption for the numerator and denominator holds true. Yet, <span class="math inline">\(\chi^2\)</span> random variables are obtained from the sums of squared normal random variables. This is why it is necessary for the residuals <span class="math inline">\(\varepsilon_i\)</span> to follow a normal distribution and/or 2) large sample theory to hold (so that the <span class="math inline">\(\varepsilon_i\)</span> may be approximately normal).</p>
<p>These <span class="math inline">\(F\)</span>-tests are sometimes given in the context of an analysis of variance (ANOVA) model and table, which presents the sum of squares explained by each variable, conditional on all previous variables in the model, and then the sum of squares for the error terms. Each test compares two models, one nested within the other. Nested models will come up again when we discuss likeli- hood ratio tests, of which the F -test is a special case under the assumption of normally-distributed outcomes.</p>
<p>A lack of significance of the effect of a covariate or group of covariates does not necessarily indicate the absence of an effect. Whether to remove these covariates from the model will depend on the scientific goal of the study.</p>
</section>
<section id="hypothesis-testing-for-nested-models-with-ordinalinteger-variables" class="level2">
<h2 class="anchored" data-anchor-id="hypothesis-testing-for-nested-models-with-ordinalinteger-variables">Hypothesis Testing for Nested Models with Ordinal/Integer Variables</h2>
<p>Suppose we want to model the relationship between year in a PhD program and some outcome where <span class="math inline">\(X \in \{ 1, 2, 3, 4, 5 \}\)</span> and <span class="math inline">\(Y\)</span> is some continuous outcome, and we have reason to believe the association might be linear.</p>
<p>We might model that as <span class="math inline">\(Y \sim \gamma_0 + \gamma_1 X\)</span> (model 1). Another way we could model it that is more flexible (not linear) is:</p>
<p><span class="math display">\[Y = \beta_0 + \beta_1 \mathbb 1(X = 1) + \beta_2 \mathbb 1(X=2)  + \beta_3 \mathbb 1(X=3)  + \beta_4 \mathbb 1(X=4)  + \beta_5 \mathbb 1(X=5) \quad \text{(model 2)}\]</span></p>
<p>What may not be so obvious is that model 1 is nested inside model 2. The crucial insight is that</p>
<p><span class="math display">\[X = \mathbb 1(X = 1) + 2 \mathbb 1(X=2) + 3 \mathbb 1(X=3) +2 \mathbb 3(X=3) +5 \mathbb 1(X=5).\]</span></p>
<p>If we were to substitute this into model 1, we have that <span class="math display">\[\begin{aligned} Y &amp; = \gamma_0 + \gamma_1 (\mathbb 1(X = 1) + 2 \mathbb 1(X=2) + 3 \mathbb 1(X=3) +2 \mathbb 3(X=3) +5 \mathbb 1(X=5)) \\
&amp; = \gamma_0 + \gamma_1 \mathbb 1(X = 1) + 2 \gamma_1 \mathbb 1(X=2) + 3 \gamma_1 \mathbb 1(X=3) + 4 \gamma_1 \mathbb 1(X=4) +5 \gamma_1 \mathbb 1(X=5)
\end{aligned}\]</span></p>
<p>Comparing this to model 2, we see that we need to construct a constraint matrix where <span class="math display">\[\beta_2 = 2 \beta_1\]</span> <span class="math display">\[\beta_3 = 3 \beta_1\]</span> <span class="math display">\[\beta_4 = 4 \beta_1\]</span> <span class="math display">\[\beta_5 = 5 \beta_1\]</span></p>
<p>Writing out our constraint matrix, we would have that</p>
<p><span class="math display">\[\begin{pmatrix}
0 &amp; 2 &amp; -1 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 3 &amp; 0 &amp; -1 &amp; 0 &amp; 0 \\
0 &amp; 4 &amp; 0 &amp; 0 &amp; -1 &amp; 0 \\
0 &amp; 5 &amp; 0 &amp; 0 &amp; 0 &amp; -1
\end{pmatrix}
\begin{pmatrix}
\beta_0 \\ \beta_1 \\ \beta_2 \\ \beta_3 \\ \beta_4 \\ \beta_5
\end{pmatrix} =
\begin{pmatrix}
0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0
\end{pmatrix}.\]</span></p>
<p>Applying this constraint to model 2 would reduce it to model 1, showing that model 1 is nested within model 2.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../week2/week2.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Week 2</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../week4/week4.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-title">Week 4</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>